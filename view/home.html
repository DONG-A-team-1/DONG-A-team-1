
<!doctype html>
<html lang="ko">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2.1.0/dist/echarts-wordcloud.min.js"></script>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>NewsPalette - Homepage</title>

    <!-- Fonts / Icons (ì›ë³¸ ìœ ì§€) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap"
      rel="stylesheet"
    />
    <!-- ë‹¤í¬í† ê¸€, í”„ë¡œí•„ ì•„ì´ì½˜ ì¶œì²˜ -->
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
        rel="stylesheet"
      />

    <link rel="stylesheet" href="./styles.css" />

   <style>
      /*ë‹¤í¬ëª¨ë“œ */
      :root {
          --primary: #3b82f6;
          --surface: #ffffff;
          --text: #1f2937;
          --muted: #6b7280;
          --border: #e5e7eb;
          --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
          --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
          --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
          --container: 1280px;
          --gray-100: #f3f4f6;
          --gray-700: #374151;
          --gray-800: #1f2937;
      }

      body.dark {
          --surface: #1f2937;
          --text: #f3f4f6;
          --muted: #9ca3af;
          --border: #374151;
      }

      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
      }

      body {
          font-family: 'Noto Sans KR', sans-serif;
          background-color: #f3f4f6;
          color: var(--text);
          transition: background-color 0.2s, color 0.2s;
          -webkit-font-smoothing: antialiased;
      }

      body.dark {
          background-color: #111827;
      }

      .container {
          max-width: var(--container);
          margin: 0 auto;
          padding: 0 16px;
      }
      /* Scrollbar */
      ::-webkit-scrollbar { width: 8px; }
      ::-webkit-scrollbar-track { background: transparent; }
      ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
      html.dark ::-webkit-scrollbar-thumb { background: #4b5563; }

      .brand {
        display: flex;
        align-items: center;
        gap: 10px;
        cursor: pointer;
      }

      .brand-icon {
        width: 32px; height: 32px;
        border-radius: 999px;
        background: var(--primary);
        color: #fff;
        display: grid;
        place-items: center;
        position: relative;
      }
      .brand-icon .material-icons-round { font-size: 18px; }

      .brand-badge {
        position: absolute;
        top: -4px; right: -4px;
        width: 12px; height: 12px;
        background: #ef4444;
        border-radius: 999px;
        border: 2px solid var(--surface);
      }

      .brand-name {
        font-weight: 900;
        font-size: 20px;
        letter-spacing: -0.02em;
      }
      /* ì¹´í…Œê³ ë¦¬ */
      /* Navigation */
      nav {
          position: sticky;
          top: 0;
          z-index: 50;
          background-color: #FFFFFF;
          border-bottom: 1px solid #E5E7EB;
          box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      }

      body.dark nav {
          background-color: #1F2937;
          border-bottom-color: #374151;
      }

      .nav-container {
          max-width: 1280px;
          margin: 0 auto;
          padding: 0 1rem;
      }
      /* ê°€ìš´ë° ì¹´í…Œê³ ë¦¬ */
        .nav-center {
            flex: 1;
            justify-content: center;
        }

      .nav-content {
          display: flex;
          align-items: center;
          justify-content: space-between; /* ì–‘ìª½ ëìœ¼ë¡œ ë°°ì¹˜ */
          height: 64px;
          position: relative; /* ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•´ í•„ìš” */
      }

      .nav-left {
          flex: 0 0 auto;
      }

      .logo {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          text-decoration: none;
          cursor: pointer;
          /* transform: scale(0.8); */
      }

      .logo-icon {
          color: #3B82F6;
          font-size: 1.875rem;
      }

      .logo-text {
          font-weight: 700;
          font-size: 1.25rem;
          color: #3B82F6;
          letter-spacing: -0.025em;
      }

      .nav-center {
        position: static;        /* absolute ì œê±° */
        display: flex;
        align-items: center;
        gap: 8px;
      }

      @media (min-width: 768px) {
          .nav-center {
              display: flex;
              align-items: center;
              gap: 0.25rem;
          }
      }

      .nav-splash-item {
          position: relative;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          padding: 0.5rem 1.25rem;
          margin: 0 0.25rem;
          font-size: 1rem;
          font-weight: 500;
          transition: all 0.3s ease;
          z-index: 10;
          color: #4B5563;
          text-decoration: none;
          white-space: nowrap;
      }

      body.dark .nav-splash-item {
          color: #D1D5DB;
      }

      .nav-splash-item::before {
          content: "";
          position: absolute;
          top: 50%;
          left: 50%;
          width: 160%;
          height: 160%;
          transform: translate(-50%, -50%) scale(0.6);
          background-color: var(--splash-color);
          -webkit-mask-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M44.7,-76.4C58.9,-69.2,71.8,-59.1,81.6,-46.6C91.4,-34.1,98.2,-19.2,95.8,-5.2C93.4,8.9,81.8,22,70.8,32.8C59.8,43.6,49.4,52,38.2,58.8C27,65.6,15,70.8,1.4,68.4C-12.2,66,-26.8,55.9,-39.7,46.7C-52.6,37.5,-63.9,29.1,-71.3,17.8C-78.7,6.5,-82.3,-7.8,-78.4,-20.9C-74.5,-34,-63.1,-46,-50.7,-53.8C-38.3,-61.6,-24.8,-65.2,-11.3,-67.2C2.2,-69.2,15.7,-69.6,30.5,-83.6L44.7,-76.4Z' transform='translate(100 100)' /%3E%3C/svg%3E");
          mask-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M44.7,-76.4C58.9,-69.2,71.8,-59.1,81.6,-46.6C91.4,-34.1,98.2,-19.2,95.8,-5.2C93.4,8.9,81.8,22,70.8,32.8C59.8,43.6,49.4,52,38.2,58.8C27,65.6,15,70.8,1.4,68.4C-12.2,66,-26.8,55.9,-39.7,46.7C-52.6,37.5,-63.9,29.1,-71.3,17.8C-78.7,6.5,-82.3,-7.8,-78.4,-20.9C-74.5,-34,-63.1,-46,-50.7,-53.8C-38.3,-61.6,-24.8,-65.2,-11.3,-67.2C2.2,-69.2,15.7,-69.6,30.5,-83.6L44.7,-76.4Z' transform='translate(100 100)' /%3E%3C/svg%3E");
          -webkit-mask-repeat: no-repeat;
          mask-repeat: no-repeat;
          -webkit-mask-position: center;
          mask-position: center;
          -webkit-mask-size: contain;
          mask-size: contain;
          opacity: 0;
          z-index: -1;
          transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      }

      .nav-splash-item:hover {
          color: var(--splash-text-color, var(--splash-color));
      }

      .nav-splash-item:hover::before {
          opacity: 0.2;
          transform: translate(-50%, -50%) scale(1.05) rotate(10deg);
      }

      .nav-splash-item.active {
          color: var(--splash-text-color, var(--splash-color));
      }

      .nav-splash-item.active::before {
          opacity: 0.35;
          transform: translate(-50%, -50%) scale(1.15);
      }

      /* .splash-society { --splash-color: #93C5FD; --splash-text-color: #1D4ED8; }
      .splash-politics { --splash-color: #FCA5A5; --splash-text-color: #B91C1C; }
      .splash-economy { --splash-color: #6EE7B7; --splash-text-color: #047857; }
      .splash-world { --splash-color: #FCD34D; --splash-text-color: #B45309; }
      .splash-tech { --splash-color: #C4B5FD; --splash-text-color: #6D28D9; } */

      .splash-society { --splash-color: #93C5FD; --splash-text-color: #1D4ED8; }
      .splash-politics { --splash-color: #FCA5A5; --splash-text-color: #B91C1C; }
      .splash-world { --splash-color: #6EE7B7; --splash-text-color: #047857; }
      .splash-international { --splash-color: #FCD34D; --splash-text-color: #B45309; }
      .splash-universe { --splash-color: #C4B5FD; --splash-text-color: #6D28D9; }
      .splash-sports { --splash-color: #3ece1a; --splash-text-color: #28d562; }

      .nav-right {
          display: flex;
          align-items: center;
          gap: 1rem;
      }

      .material-symbols-outlined {
        font-family: 'Material Symbols Outlined' !important;
        font-size: 24px;
        line-height: 1;
      }

      body.dark .dropdown-header {
          border-bottom-color: #374151;
      }

      .dropdown-subtitle {
          font-size: 0.75rem;
          color: #6B7280;
      }

      body.dark .dropdown-subtitle {
          color: #9CA3AF;
      }

      .dropdown-title {
          font-size: 0.875rem;
          font-weight: 700;
          color: #111827;
          margin-top: 0.125rem;
      }

      body.dark .dropdown-title {
          color: #FFFFFF;
      }

      .dropdown-item {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.625rem 1rem;
          font-size: 0.875rem;
          color: #374151;
          text-decoration: none;
          transition: background-color 0.2s;
          background: none;
          border: none;
          width: 100%;
          text-align: left;
          cursor: pointer;
      }

      body.dark .dropdown-item {
          color: #E5E7EB;
      }

      .dropdown-item:hover {
          background-color: #F9FAFB;
      }

      body.dark .dropdown-item:hover {
          background-color: rgba(55, 65, 81, 0.5);
      }

      .dropdown-item .material-symbols-outlined {
          font-size: 1.25rem;
          color: #9CA3AF;
          transition: color 0.2s;
      }

      body.dark .dropdown-item .material-symbols-outlined {
          color: #6B7280;
      }

      .dropdown-item:hover .material-symbols-outlined {
          color: #3B82F6;
      }

      .dropdown-item.logout-btn:hover {
          color: #EF4444;
      }

      .dropdown-item.logout-btn:hover .material-symbols-outlined {
          color: #EF4444;
      }

      /* Actions */
      .header-actions {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      /* ë‹¤í¬ëª¨ë“œ ë²„íŠ¼ */
      .icon-button {
        padding: 0.5rem;
        border-radius: 50%;
        background: none;
        border: none;
        color: var(--muted);
        cursor: pointer;
        transition: background-color 0.2s;
      }

      body.dark .icon-button {
        color: #9CA3AF;
      }

      .icon-button:hover {
        background-color: var(--gray-100);
      }

      body.dark .icon-button:hover {
        background-color: var(--gray-700);
      }

      /* =========================
        USER MENU (CLICK MODE)
      ========================= */

      .user-menu {
        position: relative;
      }

      .user-menu-button {
        position: relative;
        padding: 0.5rem;
        background: none;
        border: none;
        cursor: pointer;
      }

      .user-menu-blob {
        position: absolute;
        inset: 0;
        background-color: var(--gray-100);
        opacity: 0;
        transition: opacity 0.2s;
        transform: scale(1.3);
        border-radius: 50%;
      }

      body.dark .user-menu-blob {
        background-color: var(--gray-800);
      }

      .user-menu-button:hover .user-menu-blob {
        opacity: 1;
      }

      .user-menu-icon {
        position: relative;
        z-index: 10;
      }

      /* ğŸ”¹ ë“œë¡­ë‹¤ìš´ */
      .user-dropdown {
        position: absolute;
        top: calc(100% + 8px);
        right: 0;
        width: 220px;
        background: var(--surface);
        border-radius: 12px;
        box-shadow: 0 8px 24px rgba(0,0,0,0.12);
        display: none;
        overflow: hidden;
        z-index: 100;
        border: 1px solid var(--border);
      }

      body.dark .user-dropdown {
        border-color: #374151;
      }

      .user-dropdown.show {
        display: block;
      }

      /* ğŸ”¹ í—¤ë” */
      .dropdown-header {
        padding: 14px 16px;
        border-bottom: 1px solid var(--border);
      }

      .dropdown-subtitle {
        font-size: 12px;
        color: var(--muted);
      }

      .dropdown-title {
        font-size: 14px;
        font-weight: 700;
        margin-top: 2px;
      }

      /* ğŸ”¹ ì•„ì´í…œ */
      .dropdown-item {
        display: flex;
        align-items: center;
        gap: 10px;
        width: 100%;
        padding: 12px 16px;
        font-size: 14px;
        color: var(--text);
        background: none;
        border: none;
        cursor: pointer;
        text-decoration: none;
        transition: background-color 0.2s;
      }

      .dropdown-item:hover {
        background: color-mix(in oklab, var(--text) 8%, transparent);
      }

      .dropdown-item.logout-btn {
        color: #ef4444;
      }

      .dropdown-item.logout-btn:hover {
        background: rgba(239, 68, 68, 0.1);
      }


      /* ì‹ ë¢°ë„ ë²„íŠ¼ ---------------------------------------------*/
      .trust-wrapper {
        display: flex;
        align-items: center;
      }

      /* ë²„íŠ¼ */
      .trust-button {
        position: relative;
        display: flex;
        align-items: center;
        gap: 6px;

        padding: 6px 12px;
        font-size: 14px;
        font-weight: 500;

        color: #2563eb;
        background-color: #eff6ff;
        border: none;
        border-radius: 8px;
        cursor: pointer;

        transition: background-color 0.2s;
      }

      .trust-button:hover {
        background-color: #dbeafe;
      }

      /* ë‹¤í¬ëª¨ë“œ */
      html.dark .trust-button {
        background-color: rgba(30, 58, 138, 0.3);
        color: #93c5fd;
      }

      /* ì•„ì´ì½˜ */
      .trust-icon {
        font-size: 16px;
      }

      /* ë±ƒì§€ ìœ„ì¹˜ */
      .trust-badge {
        position: absolute;
        top: -4px;
        right: -4px;
        width: 12px;
        height: 12px;
      }

      /* ê³ ì • ì  */
      .badge-dot {
        position: relative;
        width: 12px;
        height: 12px;
        background: #3b82f6;
        border-radius: 50%;
        z-index: 2;
      }

      /* í¼ì§€ëŠ” ì• ë‹ˆë©”ì´ì…˜ */
      .badge-ping {
        position: absolute;
        inset: 0;
        background: #60a5fa;
        border-radius: 50%;
        animation: ping 1.5s infinite;
        opacity: 0.7;
      }

      @keyframes ping {
        0% {
          transform: scale(1);
          opacity: 0.7;
        }
        100% {
          transform: scale(2);
          opacity: 0;
        }
      }

      /* Main layout */
      .main { padding: 20px 16px; }

      .search-section { margin-bottom: 30px; }

        .search-bar {
            max-width: 896px;
            margin: 0 auto;
            padding: 8px;
            border-radius: 16px;
            border: 1px solid var(--border);
            background: var(--surface);
            box-shadow: var(--shadow-sm);
            display: flex;
            flex-direction: column;
            gap: 8px;
            overflow: hidden;
        }

        /* âœ… ë‹¤í¬ëª¨ë“œ search-bar */
        body.dark .search-bar {
            background: var(--surface);
            border-color: var(--border);
        }

        @media (min-width: 640px) {
            .search-bar { flex-direction: row; align-items: center; }
        }

        .select-wrap {
            position: relative;
            width: 100%;
        }
        @media (min-width: 640px) {
            .select-wrap { width: auto; }
        }

        .select {
            appearance: none;
            width: 100%;
            padding: 12px 36px 12px 16px;
            border: 0;
            border-radius: 10px;
            background: color-mix(in oklab, var(--text) 6%, transparent);
            color: color-mix(in oklab, var(--text) 88%, transparent);
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            outline: none;
        }
        @media (min-width: 640px) {
            .select { width: 128px; }
        }

        .select-caret {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
            color: var(--muted);
            pointer-events: none;
        }

        .search-input-wrap {
            position: relative;
            width: 100%;
            flex: 1;
            background: transparent;  /* âœ… ì¶”ê°€ */
            overflow: hidden;  /* âœ… ë…¸ì´ì¦ˆ ë°©ì§€ */
            border-radius: 10px;  /* âœ… ì¶”ê°€ */
            transform: translateZ(0);  /* âœ… GPU ê°€ì† */
        }

        .search-input {
            caret-color:#000000;
            width: 100%;
            padding: 12px 44px 12px 16px !important;  /* âœ… !important ê°•ì œë¡œ ë„£ëŠ” ê²ƒ*/
            border-radius: 10px;
            border: 1px solid color-mix(in oklab, var(--text) 12%, transparent);
            background: var(--surface) !important;  /* âœ… !important ì¶”ê°€ */
            color: var(--text);
            outline: none !important;  /* âœ… !important ì¶”ê°€ */
            transition: box-shadow .15s, border-color .15s;
            box-sizing: border-box;  /* âœ… ì¶”ê°€ */
            -webkit-appearance: none;  /* âœ… ì¶”ê°€ */
            appearance: none;  /* âœ… ì¶”ê°€ */
            backface-visibility: hidden;  /* âœ… ì¶”ê°€ */
            transform: translateZ(0);  /* âœ… GPU ê°€ì† */
        }
        body.dark .search-input{
           caret-color: #ffffff;
        }

        .search-input::placeholder {
            color: color-mix(in oklab, var(--text) 35%, transparent);
        }

        .search-input:focus {
            border-color: transparent;
            background: var(--surface) !important;  /* âœ… !important ì¶”ê°€ */
            box-shadow: 0 0 0 3px color-mix(in oklab, var(--primary) 35%, transparent);
        }

        .search-input:focus-visible,
        .search-input:active {
            background: var(--surface) !important;
            border-color: rgb(158, 158, 158);
            box-shadow: 0 0 0 3px color-mix(in oklab, var(--primary) 35%, transparent);
        }

        /* âœ… select ì—´ë¦´ ë•Œë„ input ë°°ê²½ ìœ ì§€ */
        .select-wrap:focus-within ~ .search-input-wrap .search-input {
            background: var(--surface) !important;
        }

        /* âœ… ë‹¤í¬ëª¨ë“œ ëª…ì‹œ */
        body.dark .search-input,
        body.dark .search-input:focus,
        body.dark .search-input:active,
        body.dark .search-input:focus-visible {
            background: var(--surface) !important;
            color: var(--text);
            border-color: var(--border);
        }

        body.dark .search-input::placeholder {
            color: var(--muted);
        }

        /* âœ… ë¸Œë¼ìš°ì € ìë™ì™„ì„± ë°°ê²½ ì œê±° */
        .search-input:-webkit-autofill,
        .search-input:-webkit-autofill:hover,
        .search-input:-webkit-autofill:focus,
        .search-input:-webkit-autofill:active {
            -webkit-box-shadow: 0 0 0 30px var(--surface) inset !important;
            -webkit-text-fill-color: var(--text) !important;
        }

        /*webkit-autofill : ë¸Œë¼ìš°ì € ìë™ì™„ì„± ìŠ¤íƒ€ì¼ ì œì–´í•˜ëŠ” css ì„ íƒì */
        body.dark .search-input:-webkit-autofill,
        body.dark .search-input:-webkit-autofill:hover,
        body.dark .search-input:-webkit-autofill:focus {
            -webkit-box-shadow: 0 0 0 30px var(--surface) inset !important;
            -webkit-text-fill-color: var(--text) !important;
        }

        .search-btn {
            position: absolute;
            top: 50%;
            right: 10px;
            transform: translateY(-50%) translateZ(0);  /* âœ… GPU ê°€ì† ì¶”ê°€ */
            border: 0;
            background: transparent;
            color: var(--primary);
            cursor: pointer;
            padding: 4px;  /* âœ… í´ë¦­ ì˜ì—­ */
            display: flex;  /* âœ… ì¶”ê°€ */
            align-items: center;  /* âœ… ì¶”ê°€ */
            justify-content: center;  /* âœ… ì¶”ê°€ */
            z-index: 2;  /* âœ… ì¶”ê°€ */
            border-radius: 4px;  /* âœ… ì¶”ê°€ */
        }

        .search-btn .material-symbols-outlined {
            font-size: 26px;
            display: block;  /* âœ… ì¶”ê°€ */
            line-height: 1;  /* âœ… ì¶”ê°€ */
        }


      /* Top grid */
      .top-grid {
        display: grid;
        gap: 15px;
        margin-bottom: 12px;
        align-items: stretch;
      }

      @media (min-width: 1024px) {
        .top-grid { grid-template-columns: 2fr 1fr; }
      }

      /* ìºëŸ¬ì…€ ê¸°ë³¸ */
      .carousel {
        position: relative;
      }

      /* ë³´ì´ëŠ” ì˜ì—­ */
      .viewport {
        overflow: hidden;
        width: 100%;
      }

      /* ì‹¤ì œë¡œ ì›€ì§ì´ëŠ” ì¤„ */
      .track {
        display: flex;
        width: 100%;
        transition: transform 0.4s ease;
      }

      /* ë©”ì¸ ê¸°ì‚¬ ì¹´ë“œ - ê³ ì • ë†’ì´ */
      .news-link {
        flex: 0 0 100%;
        width: 100%;
        max-width: 100%;
        text-decoration: none;
        color: inherit;
        display: block;
      }

      .main-news-card {
        flex: 0 0 100%;
        width: 100%;
        max-width: 100%;
        height: 500px; /* ê³ ì • ë†’ì´ */
        display: grid;
        grid-template-columns: 1.5fr 1fr; /* 1:1 ë¹„ìœ¨ */
        gap: 0;
        border-radius: 20px;
        overflow: hidden;
        background: var(--surface);
        position: relative;
        cursor: pointer;
        transition: transform .25s ease, box-shadow .25s ease;
      }

      .main-news-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-lg);
      }

      /* ì´ë¯¸ì§€ ì˜ì—­ */
      .main-news-media {
        position: relative;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }

      .main-news-media img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .media-gradient {
        position: absolute;
        inset: 0;
        background: linear-gradient(
          to bottom,
          rgba(0,0,0,0.1),
          rgba(0,0,0,0.6)
        );
      }

      .trend-chip {
        position: absolute;
        top: 16px;
        left: 16px;

        display: inline-flex;
        align-items: center;
        gap: 6px;

        padding: 6px 12px;
        border-radius: 9999px;

        background: linear-gradient(
          135deg,
          #3b82f6,
          #2563eb
        );

        color: #fff;
        font-size: 13px;
        font-weight: 600;

        box-shadow: 0 2px 6px rgba(37, 99, 235, 0.35);
      }
      .trend-chip .material-symbols-outlined { font-size: 16px; }

      /* í…ìŠ¤íŠ¸ ì˜ì—­ */
      .main-news-body {
        position: relative;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        padding: 24px;
        padding-bottom: 23px; /* ê¸°ì,ì–¸ë¡ ì‚¬ ë°‘ìœ¼ë¡œ ë‚´ë¦¬ê¸° */
        height: 100%;
        background: var(--surface);
        overflow: hidden;
      }

      html.dark .main-news-body {
        background: linear-gradient(
          to right,
          rgba(31, 41, 55, 0.96),
          rgba(31, 41, 55, 0.88)
        );
      }

      .meta-row {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 8px;
      }

      .pill {
        padding: 4px 12px;
        border-radius: 6px;
        background: rgba(59, 130, 246, 0.15);
        color: var(--primary);
        font-size: 12px;
        font-weight: 600;
      }

      .date {
        font-size: 12px;
        color: var(--muted);
      }

      /* ì œëª© */
      .main-title {
        margin: 0 0 12px;
        color: var(--text);;
        font-weight: 800;
        line-height: 1.3;
        font-size: 28px;
        display: -webkit-box;
        -webkit-line-clamp: 2; /* ìµœëŒ€ 2ì¤„ */
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
        word-break:keep-all;
      }

      html.dark .main-title {
        color: #ffffff;
      }

      @media (min-width: 768px) {
        .main-title { font-size: 32px; }
      }

      /* ì„¤ëª… */
      .main-desc {
        margin: 0 0 12px;
        color: color-mix(in oklab, var(--text) 75%, transparent);
        font-size: 14px;
        line-height: 1.6;
        display: -webkit-box;
        -webkit-line-clamp: 3; /* ìµœëŒ€ 3ì¤„ */
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
        flex: 1;
      }

      @media (min-width: 768px) {
        .main-desc { font-size: 15px; }
      }

      /* í‘¸í„° - í•˜ë‹¨ ê³ ì • */
      .article-footer {
        padding-right:100px;
        margin-top: auto;
        margin-bottom: 8px;
      }

      .article-author-info {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 13px;
        color: var(--muted);
      }

      .author-name {
        max-width: 5em;        /* í•µì‹¬: ì—¬ê¸°ì„œ ìë¦„ */
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        flex-shrink: 1;
      }
      .author-dot{
        max-width: 6em;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .author-dot::before {
        content: "â€¢";
        margin-right: 8px;
      }

      /* ì ìˆ˜ ì»¨í…Œì´ë„ˆ */
      .score-container {
        margin-top: 8px;
      }

      /* í™”ì‚´í‘œ ë²„íŠ¼ */
      .arrow {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        z-index: 10;
        background: rgba(0,0,0,0.5);
        border: none;
        color: #fff;
        padding: 12px;
        cursor: pointer;
        border-radius: 50%;
        width: 44px;
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.2s;
      }

      .arrow:hover {
        background: rgba(0,0,0,0.7);
      }

      .arrow.left { left: 12px; }
      .arrow.right { right: 12px; }

      /* ========== ë©”ì¸ ê¸°ì‚¬ ìºëŸ¬ì…€ ì ìˆ˜ ========== */
      .main-news-body .article-footer {
            margin-top: auto;
            margin-bottom: 0;
            padding-right: 100px; /* ğŸ‘ˆ ì‹ ë¢°ë„ ì ìˆ˜ ê³µê°„ í™•ë³´ */
        }
      .main-news-body .score-container {
        position: absolute;
        right: 24px;
        bottom: 20px;
        margin: 0;
        z-index: 10;
      }

      .main-news-body .trend-score,
      .main-news-body .trust-score {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 13px;
        font-weight: 500;
      }

      .main-news-body .trend-score {
        color: #eb2581;
      }

      .main-news-body .trust-score {
        color: #2563eb;
      }

      .main-news-body .trend-value {
        padding: 3px 8px;
        border-radius: 6px;
        background: #ffe6f0;
      }

      .main-news-body .trust-value {
        padding: 3px 8px;
        border-radius: 6px;
        background: #eff6ff;
      }

      html.dark .main-news-body .trend-value {
        background: rgba(235, 37, 129, 0.25);
      }

      html.dark .main-news-body .trust-value {
        background: rgba(37, 99, 235, 0.25);
      }

      /* ========== ì—°ê´€ ê¸°ì‚¬ & ê°œì¸í™” ê¸°ì‚¬ ì‹ ë¢°ë„ ì ìˆ˜ (ìš°ì¸¡ í•˜ë‹¨) ========== */
      .trust-score {
            flex-shrink: 0;        /* ì ˆëŒ€ ì¤„ì–´ë“¤ì§€ ì•ŠìŒ */
            margin-left: auto;    /*ì˜¤ë¥¸ìª½ ëìœ¼ë¡œ ë°€ê¸° */
        }
      .related-item .trust-score,
      .personal-card .trust-score {
        position: absolute;
        right: 16px;
        bottom: 12px;

        display: flex;
        align-items: center;
        gap: 6px;

        padding: 4px 10px;
        font-size: 13px;
        border-radius: 8px;

        color: #2563eb;
        background-color: #eff6ff;
      }

      html.dark .related-item .trust-score,
      html.dark .personal-card .trust-score {
        background: rgba(37, 99, 235, 0.25);
      }

      /* Related */
      .related-head {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin: 0 4px 10px;
      }
      .newslink {
        text-decoration: none;
      }
      .section-title {
        margin: 0;
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 18px;
        font-weight: 800;
      }

      .title-bar {
        display: inline-block;
        width: 6px; height: 24px;
        border-radius: 999px;
        background: var(--primary);
      }

      .more-link {
        font-size: 14px;
        text-decoration: none;
        color: var(--muted);
      }
      .more-link:hover { color: var(--primary); }

      .related-item {
        width: 100%;
        max-width: none;
        margin: 10px;
        position: relative;
        display: flex;
        cursor: pointer;
        align-items: center;
        gap: 12px;
        height: 106px;
        padding: 12px;
        border-radius: 14px;
        border: 1px solid var(--border);
        background: var(--surface);
        box-shadow: var(--shadow-sm);
        transition: box-shadow .15s, transform .15s;
        min-height: 96px;
      }

      .related-item + .related-item { margin-top: 12px; }
      .related-item:hover {
        box-shadow: var(--shadow-md);
        transform: translateY(-2px);
      }

      .thumb {
            width: 72px;          /* â­ ê³ ì • */
            height: 72px;         /* â­ ê³ ì • */
            flex-shrink: 0;       /* â­ í•µì‹¬ */
            border-radius: 10px;
            overflow: hidden;
        }

      .thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;   /* â­ ë¹„ìœ¨ í†µì¼ */
            display: block;
      }

      .related-item:hover .thumb img { transform: scale(1.1); }

      .related-text {
        flex:1;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        padding: 4px 72px 4px 0;
        min-width: 0;
        position: relative;
      }
      .related-title {
        margin: 0;
        -webkit-line-clamp: 2;
        font-size: 13px;
        font-weight: 700;
        color: color-mix(in oklab, var(--text) 92%, transparent);
        transition: color .15s;
      }
      .related-item:hover .related-title { color: var(--primary); }
      .related-time { font-size: 12px; color: color-mix(in oklab, var(--text) 45%, transparent); }

      /* Sub section */
      .sub-head { margin: 0 4px 16px; }
      .section-title-inline {
        margin: 0;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        font-size: 18px;
        font-weight: 800;
      }
      .section-title-inline .material-icons-round { color: var(--primary); }

      .sub-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 24px;
      }
      @media (min-width: 768px) {
        .sub-grid { grid-template-columns: repeat(3, 1fr); }
      }

      .sub-card {
        border-radius: 14px;
        cursor: pointer;
        overflow: hidden;
        border: 1px solid var(--border);
        background: var(--surface);
        box-shadow: var(--shadow-sm);
        display: flex;
        flex-direction: column;
        transition: box-shadow .2s ease, transform .2s ease;
      }
      .sub-card:hover {
        box-shadow: var(--shadow-lg);
        transform: translateY(-4px);
      }

      .sub-media {
        position: relative;
        height: 192px;
        background: color-mix(in oklab, var(--text) 12%, transparent);
        overflow: hidden;
      }
      .sub-media img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transform: scale(1);
        transition: transform .5s;
      }
      .sub-card:hover .sub-media img { transform: scale(1.1); }

      .tag {
        position: absolute;
        top: 8px;
        right: 8px;
        padding: 2px 8px;
        border-radius: 6px;
        background: rgba(0,0,0,.6);
        color: #fff;
        font-size: 10px;
      }

      .sub-body {
        padding: 18px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        flex: 1;
      }
      .sub-title {
        margin: 0;
        font-size: 18px;
        font-weight: 800;
        cursor: pointer;
        transition: color .15s;
        color: var(--primary);
      }
      .sub-title:hover { color: var(--primary); }

      .sub-desc {
        margin: 0;
        font-size: 13px;
        color: color-mix(in oklab, var(--text) 62%, transparent);
        line-height: 1.6;
        flex: 1;
      }
      .sub-meta {
        display: flex;
        justify-content: space-between;
        font-size: 12px;
        color: color-mix(in oklab, var(--text) 50%, transparent);
        margin-top: auto;
      }
      /* opinion */

      .opinion {
        background: var(--surface);
        border-radius: 16px;
        margin: 20px 0px 20px 0px;
        position: relative;
      }

      .opinion h3 {
        text-align: center;
        padding-top: 20px;
        padding-bottom: 0px;
      }

      .highlight {
        color: #3b82f6;
      }

      .opinion-wrap {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 60px;
        position: relative;
        padding-bottom: 20px;
      }

      .side {
        display: flex;
        flex-direction: column;
        gap: 16px;
      }

      .title {
        font-weight: bold;
        font-size: 14px;
      }

      .pill {
        padding: 10px 20px;
        border-radius: 999px;
        background: #f3e8ff;
        color: #6b21a8;
        cursor: pointer;
        transition: transform 0.3s;
      }

      .pill.warn {
        background: #fef3c7;
        color: #92400e;
      }

      .center-topic {
        width: 160px;
        height: 160px;
        border-radius: 50%;
        background: linear-gradient(135deg, #60a5fa, #2563eb);
        color: white;
        text-align: center;
        padding: 20px;
        cursor: pointer;
      }


      /* í•œ ì¤„ì§œë¦¬ ê°œì¸í™” ê¸°ì‚¬ */

      .personalized-wrap {
        max-width: 1280px;
        display: flex;
        flex-direction: column;
        gap: 16px;
        margin: 0 auto;
      }
      .personalized-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-top: 16px;
      }

      /* ğŸ”¥ ë§í¬ ë°‘ì¤„ ì œê±° */
      .news-link {
        text-decoration: none;
      }

      /* ì¹´ë“œ */
      .personal-card {
        position: relative;
        transition: box-shadow .2s ease, transform .2s ease;
        cursor: pointer;
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 24px 28px;
        min-height: 120px;
      }

      .personal-card:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-md);
        border-color: var(--primary);
      }
      /* ì œëª© ê°•ì¡° */
      .personal-card:hover .card-title {
        color: var(--primary);
      }

      /* ë¦¬ìŠ¤íŠ¸í˜• ì¹´ë“œ */
      .list-card {
        display: flex;
        align-items: center;
        gap: 16px;
        min-height: 120px;
        margin-bottom: 10px;
      }

      /* ì¸ë„¤ì¼ */
      .personal-img {
        width: 64px;
        height: 64px;
        border-radius: 12px;
        overflow: hidden;
        flex-shrink: 0;
        background: #f3f4f6;
      }
      .personal-img img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }

      /* í…ìŠ¤íŠ¸ */
      .card-text {
        display: flex;
        flex-direction: column;
        gap: 6px;
        padding-right: 80px;
      }

      .card-title {
        font-size: 15px;
        font-weight: 600;
        color: var(--text);
      }

      .card-time {
        font-size: 13px;
        color: color-mix(in oklab, var(--text) 55%, transparent);
      }


      /* Footer */
      .footer {
        margin-top: 48px;
        border-top: 1px solid var(--border);
        background: var(--surface);
        padding: 32px 0;
      }
      .footer-inner {
        text-align: center;
        color: var(--muted);
        font-size: 14px;
      }
      .footer-copy { margin: 0 0 10px; }
      .footer-links {
        display: flex;
        justify-content: center;
        gap: 16px;
      }
      .footer-links a {
        color: var(--muted);
        text-decoration: none;
      }
      .footer-links a:hover { color: var(--text); }

      /* ì›Œë“œí´ë¼ìš°ë“œ ì„¹ì…˜ */
      /* .wordcloud-section {
        background: var(--surface-light, #ffffff);
        border: 1px solid #e5e7eb;
        border-radius: 16px;
        padding: 40px 0;
        margin-top: 24px;
        height: 500px;
      } */

      body.dark .wordcloud-section {
        background: #1f2937;
        border-color: #374151;
      }

      .wordcloud-title {
        font-size: 18px;
        font-weight: 700;
        padding-bottom: 20px;
        padding-left: 26px;
        padding-top: 0px;
      }

      /* í´ë¼ìš°ë“œ ì˜ì—­ */
      .wordcloud-section {
          height: 100%; /* ì„¹ì…˜ ì „ì²´ ë†’ì´ í™•ë³´ */
          display: flex;
          flex-direction: column;
      }

      /* #wordCloudChart {
          width: 100%;
          height: 100%; /* ë¶€ëª¨ divë¥¼ ê½‰ ì±„ìš°ë„ë¡
          background-color: #ffffff;
          flex-grow: 1;
          margin: 0 auto;
      } */

      #wordCloudChart {
        width: 100%;
        height: 100%; /* 350px~450px ì •ë„ëŠ” ë˜ì–´ì•¼ í’ì„±í•´ ë³´ì…ë‹ˆë‹¤ */
        margin: 0 auto;
    }

      /* Line clamp utilities */
      .clamp-2, .clamp-3 {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }
      .clamp-2 { -webkit-line-clamp: 2; }
      .clamp-3 { -webkit-line-clamp: 3; }

      /* Footer */
      footer {
        background-color: #ffffff;
        border-top: 1px solid #e5e7eb;
        margin-top: 5rem;
        padding: 3rem 0;
      }

      body.dark footer {
        background-color: #1f2937;
        border-top-color: #374151;
      }

      .footer-container {
        max-width: 1280px;
        margin: 0 auto;
        padding: 0 1rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1.5rem;
      }

      @media (min-width: 768px) {
        .footer-container {
          flex-direction: row;
          justify-content: space-between;
        }
      }

      .footer-info {
        font-size: 0.875rem;
        color: #6b7280;
        text-align: center;
      }

      body.dark .footer-info {
        color: #9ca3af;
      }

      /* ìºëŸ¬ì…€ ì»¨í…Œì´ë„ˆ */
      .viewport {
        overflow: hidden; /* ì˜ì—­ ë°–ìœ¼ë¡œ ë‚˜ê°€ëŠ” ì¹´ë“œëŠ” ìˆ¨ê¹€ */
        width: 100%;      /* ë¶€ëª¨ ë„ˆë¹„ì— ë§ì¶¤ */
      }

      /* ì¹´ë“œê°€ ë‚˜ë€íˆ ë°°ì¹˜ë˜ëŠ” íŠ¸ë™ */
      .track {
        display: flex;          /* ì¹´ë“œë“¤ì„ ê°€ë¡œë¡œ ë‚˜ì—´ */
        transition: transform 0.4s ease; /* ì´ë™ ì• ë‹ˆë©”ì´ì…˜ */
        will-change: transform;
      }

      /* ê° ë‰´ìŠ¤ ì¹´ë“œ ë§í¬ */
      .news-link {
        flex: 0 0 100%;        /* í•œ ë²ˆì— í•˜ë‚˜ì”© ë³´ì¼ ë•Œ (ìŠ¬ë¼ì´ë“œ í˜•íƒœ) */
        text-decoration: none;
        color: inherit;
      }
    </style>
</head>

  <body>
    <nav>
      <div class="nav-container">
        <div class="nav-content">

          <!-- Logo -->
          <div class="nav-left">
            <a class="logo" href="home.html">
              <span class="material-symbols-outlined logo-icon">palette</span>
              <span class="logo-text">NewsPalette</span>
            </a>
          </div>

          <!-- Category -->
          <div class="nav-center">
                <a class="nav-splash-item splash-society" href="category.html?cat=ì‚¬íšŒ">ì‚¬íšŒ</a>
                <a class="nav-splash-item splash-politics" href="category.html?cat=ì •ì¹˜">ì •ì¹˜</a>
                <a class="nav-splash-item splash-world" href="category.html?cat=êµ­ì œ">êµ­ì œ</a>
                <a class="nav-splash-item splash-international" href="category.html?cat=ì§€ì—­">ì§€ì—­</a>
                <a class="nav-splash-item splash-universe" href="category.html?cat=ë¬¸í™”">ë¬¸í™”</a>
                <a class="nav-splash-item splash-sports" href="category.html?cat=ìŠ¤í¬ì¸ ">ìŠ¤í¬ì¸ </a>
            </div>

          <!-- Actions -->
          <div class="header-actions">
            <button class="icon-button" onclick="toggleDarkMode()">
              <span class="material-symbols-outlined">dark_mode</span>
            </button>

            <div class="user-menu">
              <button class="user-menu-button" onclick="toggleUserMenu(event)">
                <div class="user-menu-blob"></div>
                <span class="material-symbols-outlined user-menu-icon">account_circle</span>
              </button>

              <div class="user-dropdown" id="userDropdown">
                <div id="dropdownContent"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nav>


    <!-- Main -->
    <main class="container main">
      <!-- Search -->
      <section class="search-section">
        <div class="search-bar">
          <div class="select-wrap">
            <select class="select" id="searchScope" onchange="updateSearchPlaceholder(this)">
              <option style="color: black;" value="title_body">ì œëª©+ë³¸ë¬¸</option>
              <option style="color: black;" value="title">ì œëª©</option>
              <option style="color: black;" value="body">ë³¸ë¬¸</option>
              <option style="color: black;" value="keyword">í‚¤ì›Œë“œ</option>
            </select>
            <span class="material-symbols-outlined select-caret">expand_more</span>
          </div>
          <div class="search-input-wrap">
              <input id="searchInput" class="search-input" type="text" spellcheck="false" placeholder="ê´€ì‹¬ìˆëŠ” ë‰´ìŠ¤ ê¸°ì‚¬ë¥¼ ê²€ìƒ‰í•´ë³´ì„¸ìš”" onkeypress="if(event.key === 'Enter') performSearch()"/>
              <button class="search-btn" onclick="performSearch()" aria-label="ê²€ìƒ‰">
                  <span class="material-symbols-outlined">search</span>
              </button>
          </div>
        </div>
      </section>

      <!-- Top grid -->
      <section class="top-grid">

        <!-- â­ Main news (ìºëŸ¬ì…€ ì ìš©) -->
        <div class="main-news carousel">

          <!-- ì™¼ìª½ ë²„íŠ¼ -->
          <button class="arrow left" id="prevBtn">
            <span class="material-symbols-outlined">chevron_left</span>
          </button>

          <!-- ìºëŸ¬ì…€ viewport -->
          <div class="viewport">
            <div class="track" id="track">
              <a href="#" class="news-link" id="main-news-template" style="display:none;">
                <div class="main-news-card">
                  <div class="main-news-media">
                    <img class="article-img" src="" alt="news" onerror="this.src='/static/newspalette.png'" />
                    <div class="media-gradient"></div>
                    <div class="trend-chip">
                      <span class="material-symbols-outlined">trending_up</span>
                      <span class="rank-text"></span>
                    </div>
                  </div>
                  <div class="main-news-body">
                    <div class="meta-row">
                      <span class="pill category-pill">ë‰´ìŠ¤</span>
                      <span class="date article-date"></span>
                    </div>
                    <h1 class="main-title article-title"></h1>
                    <p class="main-desc clamp-3 article-desc"></p>
                    <div class="article-footer">
                      <div class="article-author-info">
                        <span class="author-name reporter-name"></span>
                        <span class="author-dot press-name"></span>
                      </div>
                    </div>
                    <div class="score-container">
                      <!-- <div class="trend-score">
                        <span class="trend-label">íŠ¸ë Œë“œ</span>
                        <span class="trend-value score-val"></span>
                      </div> --> <!-- íŠ¸ëœë“œ ìŠ¤ì½”ì–´ ì œì™¸í•¨ -->
                      <div class="trust-score">
                        <span class="trust-label">ì‹ ë¢°ë„</span>
                        <span class="trust-value trust-val"></span>
                      </div>
                    </div>
                  </div>
                </div>
              </a>
            </div>
          </div>

          <!-- ì˜¤ë¥¸ìª½ ë²„íŠ¼ -->
          <button class="arrow right" id="nextBtn">
            <span class="material-symbols-outlined">chevron_right</span>
          </button>

        </div>

        <!-- Related (ì—°ê´€ê¸°ì‚¬) -->
        <aside class="related" id="related-container">
          <div class="related-head">
            <h2 class="section-title"><span class="title-bar"></span>ì—°ê´€ ê¸°ì‚¬</h2>
          </div>

          <a href="#" class="newslink" id="related-template" style="display:none;">
            <article class="related-item">
              <div class="thumb">
                <img class="rel-img" src="" alt="Related News" />
              </div>
              <div class="related-text">
                <h3 class="related-title clamp-2 rel-title"></h3>
                <div class="article-footer">
                  <div class="article-author-info">
                    <span class="author-name rel-author"></span>
                    <span class="author-dot rel-press"></span>
                  </div>
                </div>
              </div>
              <div class="trust-score">
                <span class="trust-label">ì‹ ë¢°ë„</span>
                <span class="trust-value rel-trust"></span>
              </div>
            </article>
          </a>
        </aside>
      </section>

      <!-- ê°œì¸í™” ì¶”ì²œ ê¸°ì‚¬ -->
      <section class="personalized-wrap">
            <div class="personalized-header">
                <h2 class="section-title">
                    <span class="title-bar"></span>
                    ê°œì¸í™” ì¶”ì²œ ê¸°ì‚¬
                </h2>
                <a class="more-link" href="./user_article.html?from=main">ë”ë³´ê¸°</a>
            </div>

            <div class="personalized-list" id="personalizedList">
                <!-- ë¡œë”© ì¤‘ í‘œì‹œ (ì„ íƒì‚¬í•­) -->
                <p style="text-align:center; color:#999; padding:2rem;">
                    ì¶”ì²œ ê¸°ì‚¬ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                </p>
            </div>
        </section>

        <section class="wordcloud-section">
        <h3 class="wordcloud-title">ì˜¤ëŠ˜ì˜ í‚¤ì›Œë“œ í´ë¼ìš°ë“œ</h3>

        <div id="wordCloudChart" style="width: 100%; height: 500px;"></div>
          <!-- JSë¡œ í‚¤ì›Œë“œ ì£¼ì… -->
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-info">
                <p>Â© 2026 NewsPalette Inc. All rights reserved.</p>
            </div>
        </div>
    </footer>

  </body>
  <script>

// ê°œì¸í™” ì¶”ì²œ ê¸°ì‚¬ ë¡œë“œ í•¨ìˆ˜ ë¡œê·¸ì¸ ìœ ì €ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì¶”ì²œ API(/recommend) í˜¸ì¶œ
// - ì‘ë‹µìœ¼ë¡œ ë°›ì€ ê¸°ì‚¬ ëª©ë¡ì„ ë©”ì¸ í˜ì´ì§€ì— ë Œë”ë§
function loadPersonalizedArticles() {

    // ë¡œê·¸ì¸ ì—¬ë¶€ í™•ì¸ localStorageì— isLoggedIn === 'true' ì¸ ê²½ìš°ë§Œ ì¶”ì²œ í˜¸ì¶œ
    // â†’ ë¹„ë¡œê·¸ì¸ ìœ ì €ì—ê²ŒëŠ” ê°œì¸í™” ì¶”ì²œì„ ë…¸ì¶œí•˜ì§€ ì•ŠìŒ (ì½œë“œìŠ¤íƒ€íŠ¸ëŠ” ë³„ë„ ì •ì±…)
    const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';

    // ë¡œê·¸ì¸í•œ ìœ ì €ì˜ ê³ ìœ  ID / localStorageì— ì €ì¥ë˜ì–´ ìˆì–´ì•¼ í•¨
    //ì¶”ì²œ APIì˜ user_id íŒŒë¼ë¯¸í„°ë¡œ ì‚¬ìš©
    const userId = localStorage.getItem('userId');

    // ë¡œê·¸ì¸ ìƒíƒœ ë˜ëŠ” userIdê°€ ì—†ìœ¼ë©´ ì¦‰ì‹œ ì¢…ë£Œ - API í˜¸ì¶œ âŒ
    // - ì½˜ì†” ë¡œê·¸ë§Œ ë‚¨ê¸°ê³  í™”ë©´ ë³€ê²½ ì—†ìŒ
    if (!isLoggedIn || !userId) {
        console.log('[personalized] not logged in');
        return;
    }

    // ì¶”ì²œ ê¸°ì‚¬ API í˜¸ì¶œ GET /recommend?user_id={userId}&limit=10
    // - ì„œë²„ì—ì„œ user_embedding ì¡´ì¬ ì—¬ë¶€ì— ë”°ë¼ ê°œì¸í™” / ì½œë“œìŠ¤íƒ€íŠ¸ ì¶”ì²œ ìë™ ë¶„ê¸°
    $.ajax({
        url: '/recommend',
        type: 'GET',
        data: {
            user_id: userId, // ì–´ë–¤ ìœ ì €ì˜ ì¶”ì²œì¸ì§€
            limit: 5         // ë©”ì¸ í˜ì´ì§€ì— ë³´ì—¬ì¤„ ê¸°ì‚¬ ê°œìˆ˜
        },

        // API í˜¸ì¶œ ì„±ê³µ ì‹œ ì²˜ë¦¬
        success: function (res) {

            // ì„œë²„ ì‘ë‹µ í˜•ì‹:
            // {
            //   user_id: "xxx",
            //   recommendations: [ ... ]
            // }

            // recommendationsê°€ ì—†ìœ¼ë©´ ì•„ë¬´ ê²ƒë„ í•˜ì§€ ì•ŠìŒ
            if (!res.recommendations) return;

            // ì¶”ì²œ ê¸°ì‚¬ë“¤ì„ ë„£ì„ DOM ì»¨í…Œì´ë„ˆ
            // home.htmlì— <div id="personalizedList"></div> ê°€ ìˆì–´ì•¼ í•¨ 00
            const container = document.getElementById('personalizedList');

            // ì»¨í…Œì´ë„ˆê°€ ì—†ìœ¼ë©´ ë Œë”ë§ ë¶ˆê°€ â†’ ì½˜ì†” ê²½ê³ ë§Œ ì¶œë ¥
            if (!container) {
                console.warn('[personalized] container not found');
                return;
            }

            // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”
            // (í˜ì´ì§€ ì¬ë°©ë¬¸, ì¬í˜¸ì¶œ ì‹œ ì¤‘ë³µ ë Œë”ë§ ë°©ì§€)
            container.innerHTML = '';

            // ì¶”ì²œ ê¸°ì‚¬ ëª©ë¡ ìˆœíšŒí•˜ë©° ì¹´ë“œ ìƒì„±
            res.recommendations.forEach(article => {

                // ì´ë¯¸ì§€ ì²˜ë¦¬
                const imgSrc = article.img || '/static/newspalette.png';

                // ê¸°ìëª…/ ì–¸ë¡ ì‚¬ëª…
                const reporter = article.reporter || article.author || '';
                const press = article.press || article.source || '';

                // a íƒœê·¸ë¡œ ì¹´ë“œ ìƒì„± â†’ í´ë¦­ ì‹œ ê¸°ì‚¬ í˜ì´ì§€ë¡œ ì´ë™
                const el = document.createElement('a');

                // ê¸°ì‚¬ ìƒì„¸ í˜ì´ì§€ URL
                el.href = `/article/${article.article_id}`;

                // CSS ìŠ¤íƒ€ì¼ ì ìš©ìš© í´ë˜ìŠ¤
                el.className = 'news-link';

                // ì¹´ë“œ ë‚´ë¶€ HTML - ê¸°ì‚¬ ì œëª© - ì¶”ì²œ ì ìˆ˜ (ë””ë²„ê¹…/í™•ì¸ìš©)
                el.innerHTML = `
                    <article class="personal-card list-card">
                        <div class="personal-img">
                            <img
                                alt="ê°œì¸í™” ê¸°ì‚¬ ì´ë¯¸ì§€"
                                src="${imgSrc}"
                                onerror="this.src='https://via.placeholder.com/64x64'"
                            />
                        </div>
                        <div class="card-text">
                            <h3 class="card-title clamp-2">
                                ${article.title}
                            </h3>
                            <div class="article-author-info" style="font-size: 13px; color: #999;">
                                <span>${article.reporter}</span>
                                <span>${article.press}</span>
                            </div>
                        </div>
                        <div class="trust-score">
                            <span class="trust-label">ì¶”ì²œ</span>
                            <span class="trust-value">${article.final_score || 'â€”'}ì </span>
                        </div>
                    </article>
                `;

                //  ì™„ì„±ëœ ì¹´ë“œ DOMì— ì¶”ê°€
                container.appendChild(el);
            });
        },

        // API í˜¸ì¶œ ì‹¤íŒ¨ ì‹œ
        // - ì„œë²„ ì—ëŸ¬ - ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ - 404 / 500 ë“±
        error: function (err) {
            const container = document.getElementById('personalizedList');
            if (container) {
                container.innerHTML = `
                    <p style="text-align:center; color:#ef4444; padding:2rem;">
                        ì¶”ì²œ ê¸°ì‚¬ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.
                    </p>
                `;
            }
        }
    });
}



function performSearch() {
    const term = document.getElementById('searchInput').value.trim();
    const scope = document.getElementById('searchScope').value;
    if (term) {
        location.href = `search.html?q=${encodeURIComponent(term)}&scope=${encodeURIComponent(scope)}`;
    }
}

function updateSearchPlaceholder(select) {
    const searchInput = document.getElementById('searchInput');
    const placeholders = {
        title_body: 'ì œëª©+ë³¸ë¬¸ì—ì„œ ê´€ì‹¬ìˆëŠ” ë‰´ìŠ¤ë¥¼ ê²€ìƒ‰í•´ë³´ì„¸ìš”',
        title: 'ì œëª©ì—ì„œ ê´€ì‹¬ìˆëŠ” ë‰´ìŠ¤ë¥¼ ê²€ìƒ‰í•´ë³´ì„¸ìš”',
        body: 'ë³¸ë¬¸ì—ì„œ ê´€ì‹¬ìˆëŠ” ë‰´ìŠ¤ë¥¼ ê²€ìƒ‰í•´ë³´ì„¸ìš”',
        keyword: 'í‚¤ì›Œë“œë¡œ ê´€ì‹¬ìˆëŠ” ë‰´ìŠ¤ë¥¼ ê²€ìƒ‰í•´ë³´ì„¸ìš”'
    };
    searchInput.placeholder = placeholders[select.value];
}

$(document).ready(function () {
    let globalArticles = [];

    function loadNews() {
        $.ajax({
            url: "/api/main-trending",
            type: "GET",
            success: function (response) {
                if (response.success && response.articles) {
                    globalArticles = response.articles;
                    const $track = $('#track');
                    const $template = $('#main-news-template');

                    $track.find('.news-link:not(#main-news-template)').remove();

                    globalArticles.forEach((data, index) => {
                        const $clone = $template.clone();
                        $clone.removeAttr('id').css('display', 'block');

                        $clone.attr('href', `/article/${data.article_id}`);
                        $clone.find('.pill').text(data.category);
                        $clone.find('.article-img').attr('src', data.image);
                        $clone.find('.rank-text').text(`íŠ¸ë Œë“œ ìˆœìœ„ ${index + 1}ìœ„`);
                        $clone.find('.article-title').text(data.title);
                        $clone.find('.reporter-name').text(data.reporter);
                        $clone.find('.press-name').text(data.source);
                        $clone.find('.trust-val').text(data.trustScore + 'ì ');

                        $track.append($clone);
                    });

                    initCustomCarousel();

                    // ì²« ë¡œë“œ ì‹œ ì—°ê´€ê¸°ì‚¬ ë¡œë“œ
                    if (globalArticles.length > 0) {
                        loadRelatedArticles(globalArticles[0].article_id, globalArticles[0].title);
                    }
                }
            }
        });
    }

    function initCustomCarousel() {
        const $track = $('#track');
        let index = 0;

        // ì˜¤ë¥¸ìª½ ë²„íŠ¼ í´ë¦­
        $('#nextBtn').off('click').on('click', function() {
            const $cards = $track.find('.news-link:not(#main-news-template)');
            const totalCards = $cards.length;

            if (index < totalCards - 1) {
                index++; // ë‹¤ìŒ ì¹¸ìœ¼ë¡œ
            } else {
                index = 0; // ë§ˆì§€ë§‰ì´ë©´ ì²« ë²ˆì§¸ë¡œ ëŒì•„ê°
            }
            moveSlide($cards, index);
        });

        // ì™¼ìª½ ë²„íŠ¼ í´ë¦­
        $('#prevBtn').off('click').on('click', function() {
            const $cards = $track.find('.news-link:not(#main-news-template)');
            const totalCards = $cards.length;

            if (index > 0) {
                index--; // ì´ì „ ì¹¸ìœ¼ë¡œ
            } else {
                index = totalCards - 1; // ì²« ë²ˆì§¸ë©´ ë§ˆì§€ë§‰ìœ¼ë¡œ ëŒì•„ê°
            }
            moveSlide($cards, index);
        });

        // ìŠ¬ë¼ì´ë“œ ì´ë™ ë° ì—°ê´€ê¸°ì‚¬ ë¡œë“œ í•¨ìˆ˜
        function moveSlide($cards, currentIndex) {
            const cardWidth = $cards.outerWidth(true);
            $track.css({
                'transform': `translateX(${-currentIndex * cardWidth}px)`,
                'transition': 'transform 0.4s ease-in-out' // ë¶€ë“œëŸ¬ìš´ ì´ë™ íš¨ê³¼ ì¶”ê°€
            });

            // í˜„ì¬ ìŠ¬ë¼ì´ë“œ ë°ì´í„°ë¡œ ì—°ê´€ê¸°ì‚¬ ì—…ë°ì´íŠ¸
            if (globalArticles[currentIndex]) {
                const currentId = globalArticles[currentIndex].article_id;
                const currentTitle = globalArticles[currentIndex].title;
                loadRelatedArticles(currentId, currentTitle);
            }
        }
    }

    loadNews();
});

// ì—°ê´€ê¸°ì‚¬ í•¨ìˆ˜
function loadRelatedArticles(mainArticleId, mainArticleTitle) {
    $.ajax({
        url: "/api/related-articles",
        type: "GET",
        data: {
            id: mainArticleId,
            title: mainArticleTitle
        },
        success: function(response) {
            if (response.success && response.articles) {
                const $container = $('#related-container');
                const $template = $('#related-template');
                $container.find('.newslink:not(#related-template)').remove();

                response.articles.forEach(data => {
                    const $clone = $template.clone();
                    $clone.removeAttr('id').css('display', 'block');
                    $clone.attr('href', `/article/${data.article_id}`);
                    $clone.find('.rel-img').attr('src', data.image);
                    $clone.find('.rel-title').text(data.title);
                    $clone.find('.rel-author').text(data.reporter);
                    $clone.find('.rel-press').text(data.source);
                    $clone.find('.rel-trust').text(data.trustScore + 'ì ');
                    $container.append($clone);
                });
            }
        }
    });
}

    $(document).ready(function() {
    // 1. í˜ì´ì§€ ë¡œë“œ ì‹œ ì¦‰ì‹œ ì‹¤í–‰ í•¨ìˆ˜ ( ì¦‰ì‹œì‹¤í–‰ í•  ê²ƒ ìˆìœ¼ë©´ ì¶”ê°€ê°€ëŠ¥ )
    initApp();
    loadPersonalizedArticles();
});

function initApp() {
    // ë¡œê·¸ì¸ ì—¬ë¶€ í™•ì¸
    const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
    const savedName = localStorage.getItem('userName') || "íšŒì›";

    // 2. ì„œë²„ ì‘ë‹µ ì „ì´ë¼ë„ ë¡œì»¬ ë°ì´í„°ë¥¼ ì´ìš©í•´ UI ë¨¼ì € ë Œë”ë§
    renderUserMenu(isLoggedIn, savedName);

    if (isLoggedIn) {
        // 3. ì„œë²„ì—ì„œ ìµœì‹  ì •ë³´ ê°€ì ¸ì™€ ë™ê¸°í™”
        fetchUserInfo();
    }
}

$(document).ready(function() {  // ì›Œë“œí´ë¼ìš°ë“œ ë¶€ë¶„
    loadWordCloud();
});

function loadWordCloud() {
    $.ajax({
        url: '/api/wordcloud-data', // ë°±ì—”ë“œ ì—”ë“œí¬ì¸íŠ¸
        type: 'GET',
        success: function(options) {
            // 1. div ìš”ì†Œ ì°¾ê¸°
            const chartDom = document.getElementById('wordCloudChart');
            const myChart = echarts.init(chartDom);

            // 2. ë°±ì—”ë“œì—ì„œ ë°›ì€ ì˜µì…˜ ì ìš©
            myChart.setOption(options);

            // 3. í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€ (êµ¬ê¸€ ê²€ìƒ‰ ì—°ë™)
            myChart.on('click', function (params) {
                const keyword = params.name.replace('#', '');
                window.open(`https://www.google.com/search?q=${encodeURIComponent(keyword)}&tbm=nws`, '_blank');
            });

            // ì°½ í¬ê¸° ì¡°ì ˆ ì‹œ ë¦¬ì‚¬ì´ì¦ˆ
            window.addEventListener('resize', myChart.resize);
        }
    });
}

function fetchUserInfo() {
    $.ajax({
        url: '/get-my-info',
        type: 'GET',
        success: function(response) {
            if (response.status === "success" && response.data) {
                const user = response.data;

                // ë¸Œë¼ìš°ì € ì €ì¥ì†Œ ê°±ì‹ 
                localStorage.setItem('userName', user.name);
                localStorage.setItem('userId', user.id);  // ğŸ‘ˆ ì¶”ê°€!
                localStorage.setItem('isLoggedIn', 'true');

                // UI ì—…ë°ì´íŠ¸ (ë“œë¡­ë‹¤ìš´ & ì‚¬ì´ë“œë°”)
                renderUserMenu(true, user.name);
            }
        },
        error: function(xhr) {
            console.error("ì¸ì¦ ë¡œë“œ ì‹¤íŒ¨:", xhr.status);
            if(xhr.status === 401) {
                localStorage.setItem('isLoggedIn', 'false');
                renderUserMenu(false);
            }
        }
    });
}

// ë“œë¡­ë‹¤ìš´ ë¶€ë¶„
function renderUserMenu(isLoggedIn, userName = "íšŒì›") {

    const content = document.getElementById('dropdownContent');
    if (!content) return;

    if (isLoggedIn) {
        content.innerHTML = `
            <div class="dropdown-header">
                <p class="dropdown-subtitle">í™˜ì˜í•©ë‹ˆë‹¤!</p>
                <p class="dropdown-title" style="font-weight:bold; color:var(--text-main); margin-top:4px;">${userName}ë‹˜</p>
            </div>
            <a href="mypage.html" class="dropdown-item">
                <span class="material-symbols-outlined">account_circle</span>
                <span>ë§ˆì´í˜ì´ì§€</span>
            </a>
            <button onclick="logout()" class="dropdown-item logout" style="width:100%; border:none; background:none; cursor:pointer; text-align:left; display:flex; align-items:center; gap:8px; padding: 12px 16px; color: #ef4444;">
                <span class="material-symbols-outlined">logout</span>
                <span>ë¡œê·¸ì•„ì›ƒ</span>
            </button>
        `;
    } else {
        content.innerHTML = `
            <div class="dropdown-header">
                <p class="dropdown-subtitle">ë” ë§ì€ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´</p>
                <p class="dropdown-title" style="font-weight:bold; margin-top:4px;">ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</p>
            </div>
            <a href="login.html" class="dropdown-item">
                <span class="material-symbols-outlined">login</span>
                <span>ë¡œê·¸ì¸</span>
            </a>
            <a href="logregist.html" class="dropdown-item">
                <span class="material-symbols-outlined">person_add</span>
                <span>íšŒì›ê°€ì…</span>
            </a>
        `;
    }
}



        function logout() {
    if (!confirm("ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
    $.ajax({
        url: '/logout',
        type: 'GET',
        success: function() {
            localStorage.clear();
            alert("ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.");
            location.href = 'home.html';
        },
        error: function() {
            localStorage.clear();
            location.reload();
        }
    });
}

    // ë¡œê·¸ì¸ ì²˜ë¦¬
    $(document).ready(function () {
      renderUserDropdown();

      // ë°”ê¹¥ í´ë¦­ ì‹œ ë‹«ê¸°
      $(document).on('click', function (e) {
        if (!$(e.target).closest('.user-menu').length) {
          $('#userDropdown').removeClass('show');
        }
      });

      // ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ (ë™ì  ìƒì„± ëŒ€ì‘)
      $(document).on('click', '.logout-btn', function () {
        localStorage.setItem('isLoggedIn', 'false');
        renderUserDropdown();
        $('#userDropdown').removeClass('show');
      });
    });

    // ë©”ì¸ê¸°ì‚¬ ìºëŸ¬ì…€
    const track = document.getElementById("track");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");

    let index = 0;
    const total = track.children.length;

    function moveSlide() {
      track.style.transform = `translateX(-${index * 100}%)`;
    }

    nextBtn.addEventListener("click", () => {
      if (index < total - 1) {
        index++;
        moveSlide();
      }
    });

    prevBtn.addEventListener("click", () => {
      if (index > 0) {
        index--;
        moveSlide();
      }
    });

    // ìœ ì € ë©”ë‰´ í† ê¸€
    function toggleUserMenu(event) {
      event.stopPropagation();
      document.getElementById('userDropdown').classList.toggle('show');
    }

    // ì¹´í…Œê³ ë¦¬ ì„ íƒ ìƒ‰ìƒ ê³ ì •
    function setActiveCategoryByURL() {
      const navItems = document.querySelectorAll('.nav-splash-item');
      const currentPage = window.location.pathname.split('/').pop();

      navItems.forEach(item => {
        const href = item.getAttribute('href');
        if (href === currentPage) {
          item.classList.add('active');
        } else {
          item.classList.remove('active');
        }
      });
    }

    // ë‹¤í¬ëª¨ë“œ í† ê¸€
    function toggleDarkMode() {
      document.body.classList.toggle('dark');
      localStorage.setItem('darkMode', document.body.classList.contains('dark'));
    }

    // ë‹¤í¬ëª¨ë“œ ì´ˆê¸°í™”
    if (localStorage.getItem('darkMode') === 'true' ||
        (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches && !localStorage.getItem('darkMode'))) {
      document.body.classList.add('dark');
    }

    // ì´ˆê¸° ì‹¤í–‰
      document.addEventListener('DOMContentLoaded', () => {
          loadPersonalizedArticles();
      });
</script>
</html>