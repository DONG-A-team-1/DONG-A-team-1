<!DOCTYPE html>
<html lang="ko">
<head>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>NewsPalette - 마이페이지</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<style>



.theme-toggle {
    padding: 0.5rem;
    border-radius: 50%;
    border: none;
    background: transparent;
    color: #6b7280;
    cursor: pointer;
    transition: background-color 0.3s;
}

.theme-toggle:hover {
    background-color: #f3f4f6;
}

.dark .theme-toggle {
    color: #9ca3af;
}

.dark .theme-toggle:hover {
    background-color: #374151;
}

.theme-toggle .light-icon {
    display: none;
}

.dark .theme-toggle .dark-icon {
    display: none;
}

.dark .theme-toggle .light-icon {
    display: block;
}

.user-info {
    display: none;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    color: #4b5563;
    font-weight: bold;
    cursor: pointer;
}

@media (min-width: 640px) {
    .user-info {
        display: flex;
    }
}

.dark .user-info {
    color: #d1d5db;
}

.user-avatar {
    width: 2.25rem;
    height: 2.25rem;
    border-radius: 50%;
    background-color: #f3f4f6;
    border: 1px solid #e5e7eb;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #6b7280;
    transition: transform 0.3s;
}

.dark .user-avatar {
    background-color: #1f2937;
    border-color: #374151;
    color: #9ca3af;
}

.user-info:hover .user-avatar {
    transform: scale(1.05);
}

/* Main Content */
main {
    padding: 2rem 0;
}

.grid-layout {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1.5rem;
    max-width: 1536px;
    margin: 0 auto;
}

@media (min-width: 1024px) {
    .grid-layout {
        grid-template-columns: 1fr 3fr;
    }
}

/* Card */
.card {
    background-color: white;
    border-radius: 1rem;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    border: 1px solid #f3f4f6;
    padding: 1.5rem;
}

.dark .card {
    background-color: #1f2937;
    border-color: #374151;
}

/* Profile Section */
.profile-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 1.5rem;
}

.profile-avatar-container {
    position: relative;
    width: 6rem;
    height: 6rem;
    margin-bottom: 1rem;
}

.profile-avatar {
    width: 6rem;
    height: 6rem;
    background: linear-gradient(135deg, #dbeafe, #eff6ff);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
    color: #3b82f6;
    border: 1px solid #bfdbfe;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
    transition: transform 0.3s;
}

.dark .profile-avatar {
    background: linear-gradient(135deg, #1f2937, #374151);
    color: #60a5fa;
    border-color: #4b5563;
}

.profile-avatar-container:hover .profile-avatar {
    transform: scale(1.05);
}

.profile-edit-icon {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 2rem;
    height: 2rem;
    background-color: white;
    border-radius: 50%;
    border: 1px solid #f3f4f6;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

.dark .profile-edit-icon {
    background-color: #1f2937;
    border-color: #4b5563;
}

.profile-name {
    font-size: 1.25rem;
    font-weight: bold;
    color: #111827;
    margin-bottom: 0.25rem;
}

.dark .profile-name {
    color: white;
}

.profile-email {
    font-size: 0.75rem;
    color: #6b7280;
    font-weight: 500;
    margin-bottom: 1rem;
}

.dark .profile-email {
    color: #9ca3af;
}

.logout-btn {
    padding: 0.375rem 1rem;
    font-size: 0.75rem;
    font-weight: bold;
    color: #6b7280;
    background-color: #f9fafb;
    border: 1px solid #e5e7eb;
    border-radius: 9999px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.375rem;
    transition: all 0.3s;
}

.logout-btn:hover {
    color: #ef4444;
    background-color: #fef2f2;
    border-color: #fecaca;
}

.dark .logout-btn {
    background-color: #1f2937;
    color: #9ca3af;
    border-color: #374151;
}

.dark .logout-btn:hover {
    background-color: rgba(127, 29, 29, 0.2);
    color: #f87171;
    border-color: rgba(127, 29, 29, 0.5);
}

.divider {
    border-top: 1px solid #f3f4f6;
    margin: 1.5rem 0;
}

.dark .divider {
    border-top-color: #374151;
}

/* Donut Chart */
.chart-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 2rem;
}

.donut-chart {
    position: relative;
    width: 100px;
    height: 100px;
    border-radius: 50%;
    background: conic-gradient(
        #3b82f6 0% 40%,
        #22c55e 40% 70%,
        #a855f7 70% 90%,
        #e5e7eb 90% 100%
    );
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 1.5rem;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

.dark .donut-chart {
    background: conic-gradient(
        #3b82f6 0% 40%,
        #22c55e 40% 70%,
        #a855f7 70% 90%,
        #4b5563 90% 100%
    );
}

.donut-chart::after {
    content: "";
    position: absolute;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: #ffffff;
}

.dark .donut-chart::after {
    background: #1f2937;
}

.donut-percent {
    position: absolute;
    font-size: 1.25rem;
    font-weight: bold;
    color: #374151;
    z-index: 10;
}

.dark .donut-percent {
    color: white;
}

.donut-percent .unit {
    font-size: 0.75rem;
    font-weight: normal;
    color: #9ca3af;
}

.chart-label {
    position: absolute;
    font-size: 0.625rem;
    font-weight: bold;
    background-color: rgba(255,255,255,0.9);
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

.dark .chart-label {
    background-color: rgba(31, 41, 55, 0.9);
}

.chart-label-1 {
    color: #2563eb;
    border: 1px solid #dbeafe;
    top: 1rem;
    right: -1.75rem;
}

.dark .chart-label-1 {
    color: #60a5fa;
    border-color: rgba(30, 58, 138, 0.5);
}

.chart-label-2 {
    color: #16a34a;
    border: 1px solid #d1fae5;
    bottom: -1rem;
    left: 50%;
    transform: translateX(-50%);
}

.dark .chart-label-2 {
    color: #4ade80;
    border-color: rgba(20, 83, 45, 0.5);
}

.chart-label-3 {
    color: #9333ea;
    border: 1px solid #f3e8ff;
    left: -1.25rem;
    top: 50%;
    transform: translateY(-50%);
}

.dark .chart-label-3 {
    color: #c084fc;
    border-color: rgba(88, 28, 135, 0.5);
}

.chart-label-4 {
    color: #6b7280;
    border: 1px solid #e5e7eb;
    left: 0.25rem;
    top: -1rem;
}

.dark .chart-label-4 {
    color: #9ca3af;
    border-color: #374151;
}

.chart-legend {
    width: 100%;
    padding: 0 1rem;
}

.legend-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: 0.75rem;
    margin-bottom: 0.75rem;
}

.legend-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.legend-color {
    width: 0.75rem;
    height: 0.75rem;
    border-radius: 50%;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

.legend-color.blue { background-color: #3b82f6; }
.legend-color.green { background-color: #22c55e; }
.legend-color.purple { background-color: #a855f7; }
.legend-color.gray { background-color: #e5e7eb; }
.dark .legend-color.gray { background-color: #4b5563; }

.legend-text {
    font-weight: 500;
    color: #4b5563;
}

.dark .legend-text {
    color: #d1d5db;
}

.legend-value {
    font-weight: bold;
    color: #111827;
}

.dark .legend-value {
    color: white;
}

.reset-btn {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.625rem 1rem;
    border-radius: 0.75rem;
    font-size: 0.75rem;
    font-weight: bold;
    color: #4b5563;
    background-color: #f9fafb;
    border: 1px solid #e5e7eb;
    cursor: pointer;
    transition: all 0.3s;
    margin-top: 0.5rem;
}

.reset-btn:hover {
    background-color: #f3f4f6;
}

.dark .reset-btn {
    color: #d1d5db;
    background-color: #1f2937;
    border-color: #374151;
}

.dark .reset-btn:hover {
    background-color: #374151;
}

.reset-btn .material-icons-outlined {
    transition: transform 0.5s;
}

.reset-btn:hover .material-icons-outlined {
    transform: rotate(180deg);
}

/* Section Header */
.section-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1.5rem;
    border-bottom: 1px solid #f3f4f6;
    padding-bottom: 1rem;
}

.dark .section-header {
    border-bottom-color: #374151;
}

.section-title {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.section-title .material-icons-outlined {
    color: #3b82f6;
}

.section-title h2 {
    font-size: 1.125rem;
    font-weight: bold;
    color: #111827;
}

.dark .section-title h2 {
    color: white;
}

/* Calendar */
.calendar-controls {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
}

.calendar-title-wrapper {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.calendar-title {
    font-size: 1rem;
    font-weight: bold;
    color: #111827;
}

.dark .calendar-title {
    color: white;
}

.calendar-weeks {
    font-size: 0.75rem;
    font-weight: normal;
    color: #6b7280;
    background-color: #f3f4f6;
    padding: 0.125rem 0.5rem;
    border-radius: 9999px;
}

.dark .calendar-weeks {
    background-color: #1f2937;
}

.calendar-nav {
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.calendar-nav-btn {
    width: 2rem;
    height: 2rem;
    border-radius: 50%;
    border: none;
    background: transparent;
    color: #6b7280;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.3s;
}

.calendar-nav-btn:hover {
    background-color: #f3f4f6;
}

.dark .calendar-nav-btn:hover {
    background-color: #1f2937;
}

.calendar-container {
    background-color: white;
    border: 1px solid #f3f4f6;
    border-radius: 1rem;
    padding: 1.5rem;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

.dark .calendar-container {
    background-color: rgba(31, 41, 55, 0.2);
    border-color: rgba(55, 65, 81, 0.5);
}

.calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 0.5rem 0.5rem;
    text-align: center;
}

.calendar-day-header {
    font-size: 0.75rem;
    font-weight: 600;
    color: #9ca3af;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid #f3f4f6;
}

.dark .calendar-day-header {
    border-bottom-color: #1f2937;
}

.calendar-day {
    height: 2.5rem;
    border-radius: 0.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.875rem;
    cursor: pointer;
    transition: all 0.3s;
    position: relative;
}

@media (min-width: 640px) {
    .calendar-day {
        height: 3.5rem;
    }
}

.calendar-day.prev-month,
.calendar-day.next-month {
    color: #d1d5db;
}

.dark .calendar-day.prev-month,
.dark .calendar-day.next-month {
    color: #374151;
}

.calendar-day.no-activity {
    background-color: #f9fafb;
    color: #4b5563;
}

.dark .calendar-day.no-activity {
    background-color: rgba(31, 41, 55, 0.5);
    color: #9ca3af;
}

.calendar-day.activity-low {
    background-color: rgba(191, 219, 254, 0.5);
    color: #1e40af;
    font-weight: bold;
}

.dark .calendar-day.activity-low {
    background-color: rgba(30, 58, 138, 0.3);
    color: #93c5fd;
}

.calendar-day.activity-medium {
    background-color: rgba(96, 165, 250, 0.5);
    color: #1e3a8a;
    font-weight: bold;
}

.dark .calendar-day.activity-medium {
    background-color: rgba(37, 99, 235, 0.5);
    color: white;
}

.calendar-day.activity-high {
    background-color: rgba(59, 130, 246, 0.8);
    color: white;
    font-weight: bold;
}

.dark .calendar-day.activity-high {
    background-color: rgba(59, 130, 246, 0.8);
}

.calendar-day:hover {
    ring: 2px solid #bfdbfe;
}

.calendar-day.selected {
    background-color: #3b82f6;
    color: white;
    font-weight: 900;
    box-shadow: 0 10px 15px rgba(59, 130, 246, 0.3);
    z-index: 20;
    border: 2px solid white;
    ring: 2px solid #111827;
}

.dark .calendar-day.selected {
    border-color: #374151;
    ring-color: #f3f4f6;
}

.calendar-day.selected::before {
    content: '';
    position: absolute;
    top: -0.25rem;
    right: -0.25rem;
    width: 0.75rem;
    height: 0.75rem;
    background-color: #ef4444;
    border-radius: 50%;
    border: 2px solid white;
}

.dark .calendar-day.selected::before {
    border-color: #1f2937;
}

.calendar-tooltip {
    position: absolute;
    bottom: -2rem;
    left: 50%;
    transform: translateX(-50%);
    background-color: #111827;
    color: white;
    font-size: 0.625rem;
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    opacity: 0;
    pointer-events: none;
    white-space: nowrap;
    z-index: 30;
}

.calendar-day:hover .calendar-tooltip {
    opacity: 1;
}

.calendar-tooltip::before {
    content: '';
    position: absolute;
    top: -0.25rem;
    left: 50%;
    transform: translateX(-50%) rotate(45deg);
    width: 0.5rem;
    height: 0.5rem;
    background-color: #111827;
}

/* Stats & Activity List */
.activity-layout {
    display: flex;
    flex-direction: column;
    gap: 2rem;
}

@media (min-width: 1280px) {
    .activity-layout {
        flex-direction: row;
        gap: 2rem;
    }
}

.activity-main {
    flex: 1;
    min-width: 0;
}

.activity-sidebar {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    width: 100%;
    flex-shrink: 0;
}

@media (min-width: 1280px) {
    .activity-sidebar {
        width: 18rem;
    }
}

.stats-card {
    background: linear-gradient(135deg, #eff6ff, #dbeafe);
    border-radius: 0.75rem;
    padding: 1.25rem;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    border: 1px solid #bfdbfe;
}

.dark .stats-card {
    background: linear-gradient(135deg, rgba(30, 58, 138, 0.2), rgba(30, 64, 175, 0.1));
    border-color: rgba(30, 58, 138, 0.5);
}

.stats-label {
    font-size: 0.875rem;
    font-weight: 500;
    color: #6b7280;
    margin-bottom: 0.25rem;
}

.dark .stats-label {
    color: #9ca3af;
}

.stats-value {
    font-size: 1.875rem;
    font-weight: 900;
    color: #3b82f6;
}

.activity-list-card {
    background-color: white;
    border-radius: 0.75rem;
    border: 1px solid #f3f4f6;
    overflow: hidden;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    display: flex;
    flex-direction: column;
    height: 100%;
}

.dark .activity-list-card {
    background-color: #1f2937;
    border-color: #374151;
}

.activity-list-header {
    background-color: rgba(249, 250, 251, 0.5);
    padding: 0.75rem 1rem;
    border-bottom: 1px solid #f3f4f6;
    display: flex;
    justify-content: space-between;
    align-items: center;
    backdrop-filter: blur(4px);
}

.dark .activity-list-header {
    background-color: rgba(31, 41, 55, 0.5);
    border-bottom-color: #374151;
}

.activity-list-date {
    display: flex;
    align-items: center;
    gap: 0.375rem;
    font-size: 0.875rem;
    font-weight: bold;
    color: #111827;
}

.dark .activity-list-date {
    color: white;
}

.activity-list-date .material-icons-outlined {
    font-size: 1rem;
    color: #3b82f6;
}

.activity-list-count {
    font-size: 0.625rem;
    font-weight: bold;
    color: #6b7280;
    background-color: white;
    border: 1px solid #e5e7eb;
    padding: 0.125rem 0.375rem;
    border-radius: 9999px;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

.dark .activity-list-count {
    background-color: #374151;
    border-color: #4b5563;
}

.activity-list-items {
    overflow-y: auto;
    max-height: 300px;
}

.activity-item {
    display: block;
    padding: 0.875rem;
    text-decoration: none;
    transition: background-color 0.3s;
    border-bottom: 1px solid #f9fafb;
}

.activity-item:hover {
    background-color: #f9fafb;
}

.dark .activity-item {
    border-bottom-color: #1f2937;
}

.dark .activity-item:hover {
    background-color: rgba(31, 41, 55, 0.5);
}

.activity-item-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 0.375rem;
}

.activity-category {
    font-size: 0.625rem;
    font-weight: bold;
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    border: 1px solid;
}

.activity-category.tech {
    color: #2563eb;
    background-color: #eff6ff;
    border-color: #dbeafe;
}

.dark .activity-category.tech {
    color: #60a5fa;
    background-color: rgba(30, 58, 138, 0.3);
    border-color: rgba(30, 58, 138, 0.5);
}

.activity-category.economy {
    color: #16a34a;
    background-color: #f0fdf4;
    border-color: #d1fae5;
}

.dark .activity-category.economy {
    color: #4ade80;
    background-color: rgba(20, 83, 45, 0.3);
    border-color: rgba(20, 83, 45, 0.5);
}

.activity-category.culture {
    color: #9333ea;
    background-color: #faf5ff;
    border-color: #f3e8ff;
}

.dark .activity-category.culture {
    color: #c084fc;
    background-color: rgba(88, 28, 135, 0.3);
    border-color: rgba(88, 28, 135, 0.5);
}

.activity-category.society {
    color: #ea580c;
    background-color: #fff7ed;
    border-color: #fed7aa;
}

.dark .activity-category.society {
    color: #fb923c;
    background-color: rgba(124, 45, 18, 0.3);
    border-color: rgba(124, 45, 18, 0.5);
}

.activity-time {
    font-size: 0.625rem;
    color: #9ca3af;
    font-weight: 500;
}

.activity-title {
    font-size: 0.875rem;
    color: #374151;
    font-weight: 500;
    line-height: 1.375;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    transition: color 0.3s;
}

.dark .activity-title {
    color: #e5e7eb;
}

.activity-item:hover .activity-title {
    color: #3b82f6;
}

.activity-empty {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 2.5rem;
    color: #9ca3af;
}

.activity-empty .material-icons-outlined {
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
    opacity: 0.5;
}

.activity-empty span {
    font-size: 0.75rem;
}

/* Form Section */
.form-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1.5rem;
    margin-bottom: 2rem;
}

@media (min-width: 768px) {
    .form-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.form-label {
    font-size: 0.875rem;
    font-weight: 500;
    color: #374151;
}

.dark .form-label {
    color: #d1d5db;
}

.form-input,
.form-select {
    width: 100%;
    padding: 0.5rem 0.75rem;
    border-radius: 0.5rem;
    border: 1px solid #d1d5db;
    background-color: white;
    color: #111827;
    font-size: 0.875rem;
    transition: all 0.3s;
}

.dark .form-input,
.dark .form-select {
    border-color: #4b5563;
    background-color: #1f2937;
    color: white;
}

.form-input:focus,
.form-select:focus {
    outline: none;
    border-color: #3b82f6;
    ring: 2px solid rgba(59, 130, 246, 0.2);
}

.form-actions {
    display: flex;
    justify-content: flex-end;
}

.btn-primary {
    padding: 0.625rem 1.5rem;
    background-color: #3b82f6;
    color: white;
    font-weight: bold;
    border-radius: 0.5rem;
    border: none;
    cursor: pointer;
    font-size: 0.875rem;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    transition: background-color 0.3s;
}

.btn-primary:hover {
    background-color: #2563eb;
}

.btn-secondary {
    padding: 0.625rem 1.5rem;
    border: 1px solid #d1d5db;
    background-color: transparent;
    color: #374151;
    font-weight: bold;
    border-radius: 0.5rem;
    cursor: pointer;
    font-size: 0.875rem;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    transition: all 0.3s;
}

.btn-secondary:hover {
    background-color: #f9fafb;
}

.dark .btn-secondary {
    border-color: #4b5563;
    color: #d1d5db;
}

.dark .btn-secondary:hover {
    background-color: #374151;
}

.delete-account-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 0.75rem;
    border-radius: 0.75rem;
    border: 1px solid #fecaca;
    background-color: #fef2f2;
    color: #ef4444;
    cursor: pointer;
    transition: all 0.3s;
}

.delete-account-btn:hover {
    background-color: #fee2e2;
}

.dark .delete-account-btn {
    border-color: rgba(127, 29, 29, 0.3);
    background-color: rgba(127, 29, 29, 0.1);
    color: #f87171;
}

.dark .delete-account-btn:hover {
    background-color: rgba(127, 29, 29, 0.2);
}

.delete-account-btn .material-icons-outlined {
    margin-bottom: 0.25rem;
    transition: transform 0.3s;
}

.delete-account-btn:hover .material-icons-outlined {
    transform: scale(1.1);
}

.delete-account-btn span {
    font-size: 0.75rem;
    font-weight: bold;
}

/* Modal */
.modal-overlay {
    position: fixed;
    inset: 0;
    z-index: 50;
    display: none;
    align-items: center;
    justify-content: center;
    background-color: rgba(17, 24, 39, 0.6);
    backdrop-filter: blur(4px);
}

.modal-overlay.show {
    display: flex;
}

.modal-content {
    background-color: white;
    border-radius: 1rem;
    box-shadow: 0 20px 25px rgba(0,0,0,0.15);
    padding: 2rem;
    max-width: 28rem;
    width: 100%;
    margin: 1rem;
    border: 1px solid #f3f4f6;
    animation: fadeInUp 0.3s ease;
}

.dark .modal-content {
    background-color: #1f2937;
    border-color: #374151;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(1rem);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modal-body {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.modal-icon {
    width: 4rem;
    height: 4rem;
    background-color: #fef2f2;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 1.25rem;
    animation: bounce 1s infinite;
}

.dark .modal-icon {
    background-color: rgba(127, 29, 29, 0.2);
}

@keyframes bounce {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-0.5rem);
    }
}

.modal-icon .material-icons-outlined {
    font-size: 2.5rem;
    color: #ef4444;
}

.modal-title {
    font-size: 1.25rem;
    font-weight: bold;
    color: #111827;
    margin-bottom: 0.5rem;
}

.dark .modal-title {
    color: white;
}

.modal-description {
    font-size: 0.875rem;
    color: #6b7280;
    line-height: 1.625;
    font-weight: 500;
    margin-bottom: 2rem;
}

.dark .modal-description {
    color: #9ca3af;
}

.modal-actions {
    display: flex;
    gap: 0.75rem;
    width: 100%;
}

.modal-btn {
    flex: 1;
    padding: 0.75rem 1rem;
    border-radius: 0.75rem;
    font-weight: bold;
    font-size: 0.875rem;
    cursor: pointer;
    transition: all 0.3s;
    border: none;
}

.modal-btn-cancel {
    border: 1px solid #e5e7eb;
    background-color: transparent;
    color: #374151;
}

.modal-btn-cancel:hover {
    background-color: #f9fafb;
}

.dark .modal-btn-cancel {
    border-color: #4b5563;
    color: #d1d5db;
}

.dark .modal-btn-cancel:hover {
    background-color: #374151;
}

.modal-btn-confirm {
    background-color: #ef4444;
    color: white;
    box-shadow: 0 10px 15px rgba(239, 68, 68, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.modal-btn-confirm:hover {
    background-color: #dc2626;
}

/* Scrollbar */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: transparent;
}

::-webkit-scrollbar-thumb {
    background: #cbd5e1;
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: #94a3b8;
}

.dark ::-webkit-scrollbar-thumb {
    background: #4b5563;
}

/* Utility Classes */
.section-title .material-icons-outlined,
.activity-list-date .material-icons-outlined {
    font-size: 1.25rem;
}

:root {
    --primary: #3B82F6;
    --bg-light: #F3F4F6;
    --bg-dark: #111827;
    --surface-light: #FFFFFF;
    --surface-dark: #1F2937;
    --text-main-light: #111827;
    --text-main-dark: #F9FAFB;
    --text-sub-light: #6B7280;
    --text-sub-dark: #9CA3AF;
    --gray-100: #f3f4f6;
    --gray-200: #e5e7eb;
    --gray-300: #d1d5db;
    --gray-600: #4b5563;
    --gray-700: #374151;
    --gray-800: #1f2937;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Noto Sans KR', sans-serif;
    background-color: var(--bg-light);
    color: var(--text-main-light);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    transition: background-color 0.2s, color 0.2s;
}

body.dark {
    background-color: var(--bg-dark);
    color: var(--text-main-dark);
}

/* Navigation */
nav {
    position: sticky;
    top: 0;
    z-index: 50;
    background-color: #FFFFFF;
    border-bottom: 1px solid #E5E7EB;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

body.dark nav {
    background-color: #1F2937;
    border-bottom-color: #374151;
}

.nav-container {
    max-width: 1280px;
    margin: 0 auto;
    padding: 0 1rem;
}

.nav-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    height: 64px;
    position: relative;
}

.nav-left {
    display: flex;
    align-items: center;
}

.logo {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    text-decoration: none;
    cursor: pointer;
}

.logo-icon {
    color: #3B82F6;
    font-size: 1.875rem;
}

.logo-text {
    font-weight: 700;
    font-size: 1.25rem;
    color: #3B82F6;
    letter-spacing: -0.025em;
}

.nav-center {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    display: none;
}

@media (min-width: 768px) {
    .nav-center {
        display: flex;
        align-items: center;
        gap: 0.25rem;
    }
}

.nav-splash-item {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.5rem 1.25rem;
    margin: 0 0.25rem;
    font-weight: 500;
    transition: all 0.3s ease;
    z-index: 10;
    color: #4B5563;
    text-decoration: none;
}

body.dark .nav-splash-item {
    color: #D1D5DB;
}

.nav-splash-item::before {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 160%;
    height: 160%;
    transform: translate(-50%, -50%) scale(0.6);
    background-color: var(--splash-color);
    -webkit-mask-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M44.7,-76.4C58.9,-69.2,71.8,-59.1,81.6,-46.6C91.4,-34.1,98.2,-19.2,95.8,-5.2C93.4,8.9,81.8,22,70.8,32.8C59.8,43.6,49.4,52,38.2,58.8C27,65.6,15,70.8,1.4,68.4C-12.2,66,-26.8,55.9,-39.7,46.7C-52.6,37.5,-63.9,29.1,-71.3,17.8C-78.7,6.5,-82.3,-7.8,-78.4,-20.9C-74.5,-34,-63.1,-46,-50.7,-53.8C-38.3,-61.6,-24.8,-65.2,-11.3,-67.2C2.2,-69.2,15.7,-69.6,30.5,-83.6L44.7,-76.4Z' transform='translate(100 100)' /%3E%3C/svg%3E");
    mask-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M44.7,-76.4C58.9,-69.2,71.8,-59.1,81.6,-46.6C91.4,-34.1,98.2,-19.2,95.8,-5.2C93.4,8.9,81.8,22,70.8,32.8C59.8,43.6,49.4,52,38.2,58.8C27,65.6,15,70.8,1.4,68.4C-12.2,66,-26.8,55.9,-39.7,46.7C-52.6,37.5,-63.9,29.1,-71.3,17.8C-78.7,6.5,-82.3,-7.8,-78.4,-20.9C-74.5,-34,-63.1,-46,-50.7,-53.8C-38.3,-61.6,-24.8,-65.2,-11.3,-67.2C2.2,-69.2,15.7,-69.6,30.5,-83.6L44.7,-76.4Z' transform='translate(100 100)' /%3E%3C/svg%3E");
    -webkit-mask-repeat: no-repeat;
    mask-repeat: no-repeat;
    -webkit-mask-position: center;
    mask-position: center;
    -webkit-mask-size: contain;
    mask-size: contain;
    opacity: 0;
    z-index: -1;
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.nav-splash-item:hover {
    color: var(--splash-text-color, var(--splash-color));
}

.nav-splash-item:hover::before {
    opacity: 0.2;
    transform: translate(-50%, -50%) scale(1.05) rotate(10deg);
}

.nav-splash-item.active {
    color: var(--splash-text-color, var(--splash-color));
}

.nav-splash-item.active::before {
    opacity: 0.35;
    transform: translate(-50%, -50%) scale(1.15);
}

.splash-society { --splash-color: #93C5FD; --splash-text-color: #1D4ED8; }
.splash-politics { --splash-color: #FCA5A5; --splash-text-color: #B91C1C; }
.splash-world { --splash-color: #6EE7B7; --splash-text-color: #047857; }
.splash-international { --splash-color: #FCD34D; --splash-text-color: #B45309; }
.splash-universe { --splash-color: #C4B5FD; --splash-text-color: #6D28D9; }
.splash-sports { --splash-color: #3ece1a; --splash-text-color: #28d562; }

.nav-right {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.icon-btn {
    padding: 0.5rem;
    border-radius: 9999px;
    color: #6B7280;
    background: none;
    border: none;
    cursor: pointer;
    transition: background-color 0.2s;
}

.icon-btn:hover {
    background-color: #F3F4F6;
}

body.dark .icon-btn {
    color: #9CA3AF;
}

body.dark .icon-btn:hover {
    background-color: #374151;
}

.dropdown {
    position: relative;
}

.dropdown-menu {
    display: none;
    position: absolute;
    right: 0;
    margin-top: 0.5rem;
    width: 14rem;
    background-color: #FFFFFF;
    border-radius: 0.75rem;
    box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
    padding: 0.5rem 0;
    border: 1px solid #E5E7EB;
    z-index: 50;
}

body.dark .dropdown-menu {
    background-color: #1F2937;
    border-color: #374151;
}

.dropdown-menu.show {
    display: block;
}

.dropdown-header {
    padding: 0.75rem 1rem;
    border-bottom: 1px solid #F3F4F6;
    margin-bottom: 0.25rem;
}

body.dark .dropdown-header {
    border-bottom-color: #374151;
}

.dropdown-subtitle {
    font-size: 0.75rem;
    color: #6B7280;
}

body.dark .dropdown-subtitle {
    color: #9CA3AF;
}

.dropdown-title {
    font-size: 0.875rem;
    font-weight: 700;
    color: #111827;
    margin-top: 0.125rem;
}

body.dark .dropdown-title {
    color: #FFFFFF;
}

.dropdown-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.625rem 1rem;
    font-size: 0.875rem;
    color: #374151;
    text-decoration: none;
    transition: background-color 0.2s;
    background: none;
    border: none;
    width: 100%;
    text-align: left;
    cursor: pointer;
}

body.dark .dropdown-item {
    color: #E5E7EB;
}

.dropdown-item:hover {
    background-color: #F9FAFB;
}

body.dark .dropdown-item:hover {
    background-color: rgba(55, 65, 81, 0.5);
}

.dropdown-item .material-symbols-outlined {
    font-size: 1.25rem;
    color: #9CA3AF;
    transition: color 0.2s;
}

body.dark .dropdown-item .material-symbols-outlined {
    color: #6B7280;
}

.dropdown-item:hover .material-symbols-outlined {
    color: #3B82F6;
}

.dropdown-item.logout:hover {
    color: #EF4444;
}

.dropdown-item.logout:hover .material-symbols-outlined {
    color: #EF4444;
}


/* Header Actions (MyPage + Dark Mode) */
.header-actions {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.icon-button {
    padding: 0.5rem;
    border-radius: 50%;
    background: none;
    border: none;
    color: var(--text-sub-light);
    cursor: pointer;
}

body.dark .icon-button {
    color: var(--text-sub-dark);
}

.icon-button:hover {
    background-color: var(--gray-100);
}

body.dark .icon-button:hover {
    background-color: var(--gray-700);
}

/* User Menu */
.user-menu {
    position: relative;
}

.user-menu-button {
    position: relative;
    padding: 0.5rem;
    background: none;
    border: none;
    cursor: pointer;
}

.user-menu-blob {
    position: absolute;
    inset: 0;
    background-color: var(--gray-100);
    opacity: 0;
    transition: opacity 0.2s;
    transform: scale(1.3);
    border-radius: 50%;
}

body.dark .user-menu-blob {
    background-color: var(--gray-800);
}

.user-menu-button:hover .user-menu-blob {
    opacity: 1;
}

.user-menu-icon {
    position: relative;
    z-index: 10;
}

.user-dropdown {
    display: none;
    position: absolute;
    right: 0;
    margin-top: 0.5rem;
    width: 14rem;
    background-color: white;
    border-radius: 0.75rem;
    box-shadow: 0 10px 15px rgba(0,0,0,0.1);
    padding: 0.5rem 0;
}

body.dark .user-dropdown {
    background-color: var(--gray-800);
}

.user-dropdown.show {
    display: block;
}

</style>
</head>
<body>
<nav>
    <div class="nav-container">
        <div class="nav-content">
            <div class="nav-left">
                <a class="logo" href="home.html">
                    <span class="material-symbols-outlined logo-icon">palette</span>
                    <span class="logo-text">NewsPalette</span>
                </a>
            </div>
            <div class="nav-center">
                <a class="nav-splash-item splash-society" href="category.html?cat=사회">사회</a>
                <a class="nav-splash-item splash-politics" href="category.html?cat=정치">정치</a>
                <a class="nav-splash-item splash-world" href="category.html?cat=국제">국제</a>
                <a class="nav-splash-item splash-international" href="category.html?cat=지역">지역</a>
                <a class="nav-splash-item splash-universe" href="category.html?cat=문화">문화</a>
                <a class="nav-splash-item splash-sports" href="category.html?cat=스포츠">스포츠</a>
            </div>
     <div class="header-actions">
    <button class="icon-button" onclick="toggleDarkMode()">
        <span class="material-symbols-outlined">dark_mode</span>
    </button>

    <div class="user-menu">
        <button class="user-menu-button" onclick="toggleUserMenu()">
            <div class="user-menu-blob"></div>
            <span class="material-symbols-outlined user-menu-icon">account_circle</span>
        </button>

        <div class="user-dropdown" id="userDropdown">
            <div id="dropdownContent"></div>
        </div>
    </div>
</div>

</nav>

<main>
    <div class="container">
        <div class="grid-layout">
            <aside>
                <div class="card">
                    <div class="profile-section">
                        <div class="profile-avatar-container">
                            <div class="profile-avatar">
                                <span class="material-symbols-outlined">person</span>
                            </div>
                        </div>
                        <h2 class="profile-name" id="display-user-name">유저 ID명</h2>
                        <p class="profile-email" id="display-user-email">news_enthusiast@example.com</p>
                        <button class="logout-btn" onclick="logout()">
                            <span class="material-icons-outlined" style="font-size: 0.875rem;">logout</span>
                            로그아웃
                        </button>
                    </div>
                    
                    <div class="divider"></div>
                    
                    <div>
                        <div class="section-title" style="margin-bottom: 1.5rem;">
                            <span class="material-icons-outlined" style="color: #6b7280;">history</span>
                            <h3 style="font-weight: bold; color: #111827;">개인 조회 카테고리</h3>
                        </div>
                        
                        <div class="chart-section">
                            <div style="position: relative; margin-bottom: 1.5rem;">
                                <div class="donut-chart" id="algorithm-chart">
                                    <span class="donut-percent" id="algorithm-percent">40<span class="unit">%</span></span>
                                    <span class="chart-label chart-label-1">IT/과학</span>
                                    <span class="chart-label chart-label-2">경제</span>
                                    <span class="chart-label chart-label-3">문화</span>
                                    <span class="chart-label chart-label-4">기타</span>
                                </div>
                            </div>
                            
                            <div class="chart-legend" id="category-legend">
                                <div class="legend-item">
                                    <div class="legend-label">
                                        <span class="legend-color blue"></span>
                                        <span class="legend-text">IT/과학</span>
                                    </div>
                                    <span class="legend-value">40%</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-label">
                                        <span class="legend-color green"></span>
                                        <span class="legend-text">경제</span>
                                    </div>
                                    <span class="legend-value">30%</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-label">
                                        <span class="legend-color purple"></span>
                                        <span class="legend-text">문화</span>
                                    </div>
                                    <span class="legend-value">20%</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-label">
                                        <span class="legend-color gray"></span>
                                        <span class="legend-text">기타</span>
                                    </div>
                                    <span class="legend-value">10%</span>
                                </div>
                            </div>
                        </div>
                        
                        <div style="padding-top: 0.5rem; border-top: 1px solid #f3f4f6;">
                            <button class="reset-btn" onclick="resetAlgorithm()">
                                <span class="material-icons-outlined" style="font-size: 0.875rem;">restart_alt</span>
                                <span>알고리즘 초기화</span>
                            </button>
                        </div>
                    </div>
                </div>
            </aside>
            
            <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                <section class="card">
                    <div class="section-header">
                        <div class="section-title">
                            <span class="material-icons-outlined">calendar_month</span>
                            <h2>최근 활동 분석</h2>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.75rem;">
                            <div class="legend-item"><span class="dot no"></span><span>활동 없음</span></div>
                            <div class="legend-item"><span class="dot low"></span><span>적음</span></div>
                            <div class="legend-item"><span class="dot medium"></span><span>보통</span></div>
                            <div class="legend-item"><span class="dot high"></span><span>많음</span></div>
                        </div>
                    </div>
                    
                    <div class="activity-layout">
                        <div class="activity-main">
                            <div class="calendar-controls">
                                <div class="calendar-title-wrapper">
                                    <span class="calendar-title" id="calendar-title">2024년 3월</span>
                                    <!-- <span class="calendar-weeks" id="calendar-weeks">로드 중...</span> -->
                                </div>
                                <div class="calendar-nav">
                                    <button class="calendar-nav-btn" onclick="changeMonth(-1)">
                                        <span class="material-icons-outlined">chevron_left</span>
                                    </button>
                                    <button class="calendar-nav-btn" onclick="changeMonth(1)">
                                        <span class="material-icons-outlined">chevron_right</span>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="calendar-container">
                                <div class="calendar-grid" id="calendar-grid">
                                    <div class="calendar-day-header">일</div>
                                    <div class="calendar-day-header">월</div>
                                    <div class="calendar-day-header">화</div>
                                    <div class="calendar-day-header">수</div>
                                    <div class="calendar-day-header">목</div>
                                    <div class="calendar-day-header">금</div>
                                    <div class="calendar-day-header">토</div>

                                    <div class="calendar-day no-activity">1</div>
                                    <div class="calendar-day no-activity">2</div>
                                    <div class="calendar-day no-activity">3</div>
                                    <div class="calendar-day no-activity">4</div>
                                    <div class="calendar-day no-activity">5</div>
                                    <div class="calendar-day no-activity">6</div>
                                    <div class="calendar-day no-activity">7</div>
                                    <div class="calendar-day no-activity">8</div>
                                    <div class="calendar-day no-activity">9</div>
                                    <div class="calendar-day no-activity">10</div>
                                    <div class="calendar-day no-activity">11</div>
                                    <div class="calendar-day no-activity">12</div>
                                    <div class="calendar-day no-activity">13</div>
                                    <div class="calendar-day no-activity">14</div>
                                    <div class="calendar-day no-activity">15</div>
                                    <div class="calendar-day no-activity">16</div>
                                    <div class="calendar-day no-activity">17</div>
                                    <div class="calendar-day no-activity">18</div>
                                    <div class="calendar-day no-activity">19</div>
                                    <div class="calendar-day no-activity">20</div>
                                    <div class="calendar-day no-activity">21</div>
                                    <div class="calendar-day no-activity">22</div>
                                    <div class="calendar-day no-activity">23</div>
                                    <div class="calendar-day no-activity">24</div>
                                    <div class="calendar-day no-activity">25</div>
                                    <div class="calendar-day no-activity">26</div>
                                    <div class="calendar-day no-activity">27</div>
                                    <div class="calendar-day no-activity">28</div>
                                    <div class="calendar-day no-activity">29</div>
                                    <div class="calendar-day no-activity">30</div>
                                    <div class="calendar-day no-activity">31</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="activity-sidebar">
                            <div class="stats-card">
                                <span class="stats-label">총 기사 조회수</span>
                                <div style="display: flex; align-items: flex-end; gap: 0.5rem;">
                                    <span class="stats-value" id="total-view-count">0</span>
                                </div>
                            </div>
                            
                            <div class="activity-list-card">
                                <div class="activity-list-header">
                                    <div class="activity-list-date">
                                        <span class="material-icons-outlined">event_note</span>
                                        <span id="list-date">날짜를 선택하세요</span>
                                    </div>
                                    <span class="activity-list-count" id="list-count">0건</span>
                                </div>
                                <div class="activity-list-items" id="list-items">
                                    <div class="activity-empty">기록이 없습니다.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <section class="card">
                    <div class="section-header">
                        <div class="section-title">
                            <span class="material-icons-outlined" style="color: #6b7280;">badge</span>
                            <h2>정보 변경</h2>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">이름</label>
                            <input class="form-input" type="text" id="user-name" value="유저 ID명" /> 
                        </div>
                        <div class="form-group">
                            <label class="form-label">성별</label>
                            <select class="form-select" id="user-gender">
                                <option value="male">남성</option>
                                <option value="female">여성</option>
                                <option value="none">선택안함</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">생년월일</label>
                            <input class="form-input" type="date" id="user-birth" value="2000-01-01"/> 
                        </div>
                        <div class="form-group">
                            <label class="form-label">이메일</label>
                            <input class="form-input" type="email" id="user-email" value="news_enthusiast@example.com" placeholder="example@email.com"/> 
                        </div>
                    </div>
                    <div class="form-actions">
                        <button class="btn-primary" onclick="saveUserInfo()">변경 사항 저장</button>
                    </div>
                </section>
                
                <section class="card">
                    <div class="section-header">
                        <div class="section-title">
                            <span class="material-icons-outlined" style="color: #6b7280;">lock_reset</span>
                            <h2>비밀번호 변경</h2>
                        </div>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 1rem; margin-bottom: 1.5rem;">
                        <div class="form-group">
                            <label class="form-label">현재 비밀번호</label>
                            <input class="form-input" id="current-password" placeholder="••••••••" type="password"/>
                        </div>
                        <div class="form-group">
                            <label class="form-label">새 비밀번호</label>
                            <input class="form-input" id="new-password" type="password" placeholder="새 비밀번호 입력"/>
                        </div>
                        <div class="form-group">
                            <label class="form-label">새 비밀번호 확인</label>
                            <input class="form-input" id="confirm-password" type="password" placeholder="비밀번호 확인"/>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button class="btn-secondary" onclick="updatePassword()">비밀번호 업데이트</button>
                    </div>
                </section>
                
                <div style="display: flex; justify-content: flex-end; padding-top: 1rem;">
                    <button class="delete-account-btn" onclick="openWithdrawModal()">
                        <span class="material-icons-outlined">person_remove</span>
                        <span>회원탈퇴</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</main>

<div class="modal-overlay" id="confirm-dialog">
    <div class="modal-content">
        <div class="modal-body">
            <div class="modal-icon">
                <span class="material-icons-outlined">priority_high</span>
            </div>
            <h3 class="modal-title">탈퇴하시겠습니까?</h3>
            <p class="modal-description">탈퇴시 데이터 삭제 및 복구 불가</p>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-cancel" onclick="document.getElementById('confirm-dialog').classList.remove('show')">
                    취소
                </button>
                <button class="modal-btn modal-btn-confirm" onclick="confirmWithdrawal()">
                    <span class="material-icons-outlined" style="font-size: 0.875rem;">check</span>
                    탈퇴하기
                </button>
            </div>
        </div>
    </div>
</div>

<script>
/* ============================================================
   1. 초기화 및 상태 관리 (로그인, 다크모드, 카테고리)
============================================================ */
// 시스템 실제 날짜 기준으로 초기화
let currentCalendarDate = new Date(); 

$(document).ready(function() {
    initApp();
    setActiveCategoryByURL(); // 현재 페이지 메뉴 활성화
});

function initApp() {
    // 다크모드 초기화
    initDarkMode();

    // 캘린더 초기화 (실제 시스템 날짜 기반)
    updateCalendarUI();

    // 로그인 정보 확인 및 UI 동기화
    const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
    const savedName = localStorage.getItem('userName') || "회원";
    renderUserMenu(isLoggedIn, savedName);

    if (isLoggedIn) fetchUserInfo();
}

/* ============================================================
   2. 유저 정보 및 인증 관련 (기존 기능 유지)
============================================================ */
function initDarkMode() {
    const isDark = localStorage.getItem('darkMode') === 'true' || 
                  (!localStorage.getItem('darkMode') && window.matchMedia('(prefers-color-scheme: dark)').matches);
    if (isDark) document.body.classList.add('dark');
}

function toggleDarkMode() {
    const isDark = document.body.classList.toggle('dark');
    localStorage.setItem('darkMode', isDark);
}

function fetchUserInfo() {
    $.get('/get-my-info', function(response) {
        if (response.status === "success" && response.data) {
            const user = response.data;
            localStorage.setItem('userName', user.name);
            localStorage.setItem('isLoggedIn', 'true');
            renderUserMenu(true, user.name);
            updateProfileUI(user);
        }
    }).fail(function(xhr) {
        if(xhr.status === 401) {
            localStorage.setItem('isLoggedIn', 'false');
            renderUserMenu(false);
        }
    });
}

function updateProfileUI(user) {
    $('.profile-name').text(user.name + "님");
    $('.profile-email').text(user.email);
    if($('#user-name').length) $('#user-name').val(user.name);
    if($('#user-email').length) $('#user-email').val(user.email);
    if($('#user-birth').length) $('#user-birth').val(user.birth);
    if($('#user-gender').length) $('#user-gender').val(user.gender);
}

function saveUserInfo() {
    const data = {
        name: $('#user-name').val().trim(),
        gender: $('#user-gender').val(),
        birth: $('#user-birth').val(),
        email: $('#user-email').val().trim()
    };
    if(!Object.values(data).every(x => x)) return alert("모든 정보를 입력해주세요.");
    $.ajax({
        url: '/update-info',
        type: 'POST',
        contentType: 'application/json',
        data: JSON.stringify(data),
        success: function() {
            alert("정보가 변경되었습니다.");
            location.reload();
        },
        error: (xhr) => alert("수정 실패: " + (xhr.responseJSON?.message || "오류 발생"))
    });
}

function logout() {
    if (!confirm("로그아웃 하시겠습니까?")) return;
    $.get('/logout', function() {
        localStorage.clear();
        alert("로그아웃 되었습니다.");
        location.href = 'home.html';
    }).fail(() => { localStorage.clear(); location.reload(); });
}

function renderUserMenu(isLoggedIn, userName = "회원") {
    const content = document.getElementById('dropdownContent');
    if (!content) return;
    if (isLoggedIn) {
        content.innerHTML = `
            <div class="dropdown-header">
                <p class="dropdown-subtitle">환영합니다!</p>
                <p class="dropdown-title" style="font-weight:bold; color:var(--text-main); margin-top:4px;">${userName}님</p>
            </div>
            <button onclick="logout()" class="dropdown-item logout" style="width:100%; border:none; background:none; cursor:pointer; text-align:left; display:flex; align-items:center; gap:8px; padding: 12px 16px; color: #ef4444;">
                <span class="material-symbols-outlined">logout</span>
                <span>로그아웃</span>
            </button>`;
    } else {
        content.innerHTML = `
            <div class="dropdown-header"><p class="dropdown-subtitle">로그인이 필요합니다</p></div>
            <a href="login.html" class="dropdown-item"><span class="material-symbols-outlined">login</span>로그인</a>
            <a href="logregist.html" class="dropdown-item"><span class="material-symbols-outlined">person_add</span>회원가입</a>`;
    }
}

function setActiveCategoryByURL() {
    const navItems = document.querySelectorAll('.nav-splash-item');
    const currentPage = window.location.pathname.split('/').pop();
    navItems.forEach(item => {
        item.classList.toggle('active', item.getAttribute('href') === currentPage);
    });
}

/* ============================================================
   3. 캘린더 및 활동 내역 (35칸 고정 + ES 연동)
============================================================ */

// ES 필드: article_id, press, read_time, title 활용
function generateArticleHTML(article) {
    return `
        <a class="activity-item" href="/article/${article.article_id}">
            <div class="activity-item-header">
                <span class="activity-category high">${article.press || '뉴스'}</span>
                <span class="activity-time">${article.read_time || ''}</span>
            </div>
            <h5 class="activity-title">${article.title}</h5>
        </a>`;
}

// 달력 그리기 (핵심: 35칸 고정 및 오늘 날짜 자동 선택)
function renderGenericGrid(year, month) {
    const grid = document.getElementById('calendar-grid');
    if (!grid) return;
    
    grid.innerHTML = '';
    
    // 요일 헤더 생성
    ['일','월','화','수','목','금','토'].forEach(d => {
        const h = document.createElement('div'); 
        h.className='calendar-day-header'; 
        h.textContent=d; 
        grid.appendChild(h);
    });

    const firstDay = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month + 1, 0).getDate();
    const prevMonthDays = new Date(year, month, 0).getDate();
    
    // 1. 이전 달 날짜 채우기
    for (let i = 0; i < firstDay; i++) {
        const d = document.createElement('div'); 
        d.className='calendar-day prev-month';
        d.textContent = prevMonthDays - firstDay + 1 + i; 
        grid.appendChild(d);
    }

    // 2. 이번 달 날짜 채우기
    const today = new Date();
    const isTodayMonth = (today.getFullYear() === year && today.getMonth() === month);

    for (let i = 1; i <= daysInMonth; i++) {
        const d = document.createElement('div');
        d.className = 'calendar-day no-activity';
        d.textContent = i;
        
        // 오늘 날짜면 자동 선택 클래스 부여 및 데이터 호출
        if (isTodayMonth && i === today.getDate()) {
            d.classList.add('selected');
            updateList(i); 
        }
        grid.appendChild(d);
    }

    // 3. 다음 달 날짜로 35칸 맞추기 (무조건 5줄 고정)
    const currentCells = grid.querySelectorAll('.calendar-day').length;
    const remaining = 35 - currentCells;
    if (remaining > 0) {
        for (let i = 1; i <= remaining; i++) {
            const d = document.createElement('div');
            d.className = 'calendar-day next-month';
            d.textContent = i;
            grid.appendChild(d);
        }
    }
}

// 리스트 업데이트 (ES API 연동)
async function updateList(day) {
    const listContainer = document.getElementById('list-items');
    const listDate = document.getElementById('list-date');
    const listCount = document.getElementById('list-count');
    
    // 안전하게 숫자형으로 변환
    const dayNum = parseInt(day);
    if (isNaN(dayNum)) return;

    const year = currentCalendarDate.getFullYear();
    const month = currentCalendarDate.getMonth();
    const dateObj = new Date(year, month, dayNum);
    
    const dayOfWeek = ['일', '월', '화', '수', '목', '금', '토'][dateObj.getDay()];
    listDate.textContent = `${month + 1}월 ${dayNum}일 (${dayOfWeek})`;
    
    // 백엔드 형식을 맞추기 위해 0을 채운 YYYY-MM-DD 생성
    const formattedDate = `${year}-${String(month + 1).padStart(2, '0')}-${String(dayNum).padStart(2, '0')}`;
    
    console.log("요청 전송 데이터:", formattedDate); // 보내는 날짜

    listContainer.innerHTML = '<div class="activity-empty">조회 중...</div>';

    try {
        const response = await fetch(`/api/user/history?date=${formattedDate}`);
        const data = await response.json();

        if (data.success && data.articles && data.articles.length > 0) {
            listCount.textContent = `${data.articles.length}건`;
            listContainer.innerHTML = data.articles.map(generateArticleHTML).join('');
        } else {
            listCount.textContent = `0건`;
            listContainer.innerHTML = `<div class="activity-empty">조회 내역이 없습니다.</div>`;
        }
    } catch (e) {
        console.error("데이터 로드 오류:", e);
        listContainer.innerHTML = `<div class="activity-empty">서버 연결 오류</div>`;
    }
}

function updateCalendarUI() {
    const year = currentCalendarDate.getFullYear();
    const month = currentCalendarDate.getMonth();
    document.getElementById('calendar-title').textContent = `${year}년 ${month + 1}월`;

    // 35칸 그리드 렌더링
    renderGenericGrid(year, month);
    // 클릭 이벤트 재연결
    setupGridInteractions();
}


function setupGridInteractions() {
    const grid = document.getElementById('calendar-grid');
    const clickableDays = grid.querySelectorAll('.calendar-day:not(.prev-month):not(.next-month)');
    clickableDays.forEach(dayEl => {
        dayEl.onclick = function() {
            clickableDays.forEach(d => d.classList.remove('selected'));
            this.classList.add('selected');
            // 툴팁 등을 제외한 순수 날짜 숫자만 추출
            const dayValue = this.childNodes[0].textContent.trim();
            updateList(dayValue);
        };
    });
}

function changeMonth(delta) {
    currentCalendarDate.setMonth(currentCalendarDate.getMonth() + delta);
    updateCalendarUI();
}

// 바깥 클릭 시 드롭다운 닫기
document.addEventListener('click', (e) => {
    const menu = document.querySelector('.user-menu');
    const dropdown = document.getElementById('userDropdown');
    if (dropdown && menu && !menu.contains(e.target)) {
        dropdown.classList.remove('show');
    }
});
</script>
</body>
</html>