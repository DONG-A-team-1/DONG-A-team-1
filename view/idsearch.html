<!DOCTYPE html>
<html lang="ko">
<head>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>NewsPalette - 아이디 찾기</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet"/>
<style>
:root {
    --primary: #10B981;
    --primary-dark: #059669;
    --bg-light: #F3F4F6;
    --bg-dark: #111827;
    --surface-light: #FFFFFF;
    --surface-dark: #1F2937;
    --border-light: #E5E7EB;
    --border-dark: #374151;
    --gray-50: #f9fafb;
    --gray-100: #f3f4f6;
    --gray-200: #e5e7eb;
    --gray-300: #d1d5db;
    --gray-400: #9ca3af;
    --gray-500: #6b7280;
    --gray-600: #4b5563;
    --gray-700: #374151;
    --gray-800: #1f2937;
    --gray-900: #111827;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Noto Sans KR', sans-serif;
    background-color: var(--bg-light);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 1rem;
    transition: background-color 0.3s, color 0.3s;
}

body.dark {
    background-color: var(--bg-dark);
}

/* Animation */
.fade-in {
    animation: fadeIn 0.4s ease-in-out;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.hidden-section {
    display: none !important;
}

/* Main Container */
.main-container {
    width: 100%;
    max-width: 28rem;
    background-color: var(--surface-light);
    border-radius: 1.5rem;
    box-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.5);
    padding: 2rem;
    position: relative;
    overflow: hidden;
}

body.dark .main-container {
    background-color: var(--surface-dark);
    border-color: rgba(55, 65, 81, 0.5);
}

@media (min-width: 768px) {
    .main-container {
        padding: 2.5rem;
    }
}

/* Header */
.header {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 2rem;
}

.logo-circle {
    width: 4rem;
    height: 4rem;
    background-color: #d1fae5;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 1rem;
    color: var(--primary);
}

body.dark .logo-circle {
    background-color: rgba(5, 150, 105, 0.3);
}

.logo-circle .material-icons-round {
    font-size: 1.875rem;
}

.logo-circle a {
    text-decoration: none; /* 밑줄 제거 */
    color: inherit;        /* 부모인 .logo-circle의 color(--primary)를 그대로 사용 */
    display: flex;         /* 중앙 정렬 유지 */
    align-items: center;
    justify-content: center;
    width: 100%;           /* 원 전체를 클릭 가능하게 만듦 */
    height: 100%;
}

/* 방문 후에도 색이 변하지 않도록 고정 */
.logo-circle a:visited {
    color: inherit;
}

.header-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--gray-900);
    letter-spacing: -0.025em;
}

body.dark .header-title {
    color: white;
}

.header-subtitle {
    color: var(--gray-500);
    margin-top: 0.25rem;
    font-weight: 500;
}

body.dark .header-subtitle {
    color: var(--gray-400);
}

/* Form Section */
.form-section {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.form-label {
    display: block;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--gray-600);
    margin-left: 0.25rem;
}

body.dark .form-label {
    color: var(--gray-300);
}

/* Input with Icon */
.input-wrapper {
    position: relative;
}

.input-icon {
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    padding-left: 0.75rem;
    display: flex;
    align-items: center;
    pointer-events: none;
    color: var(--gray-400);
    transition: color 0.2s;
}

.input-wrapper:focus-within .input-icon {
    color: var(--primary);
}

.form-input {
    display: block;
    width: 100%;
    padding: 0.75rem 0.75rem 0.75rem 2.5rem;
    border: 1px solid var(--border-light);
    border-radius: 0.75rem;
    background-color: var(--gray-50);
    color: var(--gray-900);
    font-size: 1rem;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    transition: all 0.2s;
}

body.dark .form-input {
    border-color: var(--border-dark);
    background-color: var(--gray-800);
    color: white;
}

.form-input::placeholder {
    color: var(--gray-400);
}

.form-input:focus {
    outline: none;
    box-shadow: 0 0 0 2px var(--primary);
    border-color: transparent;
}

/* Submit Button */
.submit-button {
    width: 100%;
    background-color: var(--primary);
    color: white;
    font-weight: 700;
    padding: 0.875rem 1rem;
    border-radius: 0.75rem;
    box-shadow: 0 10px 15px -3px rgba(16, 185, 129, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    border: none;
    cursor: pointer;
    transition: all 0.2s;
}

.submit-button:hover {
    background-color: var(--primary-dark);
}

.submit-button:active {
    transform: scale(0.98);
}

.submit-button .material-icons-round {
    font-size: 1.125rem;
}

/* Result Section */
.result-section {
    display: flex;
    flex-direction: column;
    gap: 2rem;
    text-align: center;
    padding-top: 0.5rem;
}

.result-header {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.result-text {
    color: var(--gray-500);
    font-size: 0.875rem;
}

body.dark .result-text {
    color: var(--gray-400);
}

.result-box {
    border: 2px solid rgba(16, 185, 129, 0.2);
    background-color: rgba(16, 185, 129, 0.05);
    padding: 1rem 1.5rem;
    border-radius: 0.75rem;
}

body.dark .result-box {
    background-color: rgba(16, 185, 129, 0.1);
    border-color: rgba(16, 185, 129, 0.3);
}

.result-label {
    font-size: 1.125rem;
    font-weight: 500;
    color: var(--gray-800);
}

body.dark .result-label {
    color: var(--gray-200);
}

.result-id {
    font-weight: 700;
    color: var(--gray-900);
    font-size: 1.25rem;
    margin-left: 0.25rem;
}

body.dark .result-id {
    color: white;
}

/* Action Buttons */
.action-buttons {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.back-button {
    display: block;
    width: 100%;
    background-color: white;
    border: 1px solid var(--gray-300);
    color: var(--gray-700);
    font-weight: 500;
    padding: 0.875rem 1rem;
    border-radius: 0.75rem;
    text-decoration: none;
    text-align: center;
    transition: all 0.2s;
    font-size: 0.875rem;
}

body.dark .back-button {
    background-color: transparent;
    border-color: var(--gray-600);
    color: var(--gray-200);
}

.back-button:hover {
    background-color: var(--gray-50);
}

body.dark .back-button:hover {
    background-color: var(--gray-700);
}

.reset-button {
    font-size: 0.75rem;
    color: var(--gray-400);
    text-decoration: underline;
    text-underline-offset: 2px;
    background: none;
    border: none;
    cursor: pointer;
    transition: color 0.2s;
}

.reset-button:hover {
    color: var(--gray-600);
}

body.dark .reset-button:hover {
    color: var(--gray-300);
}

/* Footer */
.footer {
    margin-top: 2rem;
    text-align: center;
}

.footer-text {
    font-size: 0.75rem;
    color: var(--gray-400);
}

body.dark .footer-text {
    color: var(--gray-500);
}

/* --- Select 태그를 Input과 동일하게 맞춤 --- */
.form-select {
    width: 100%;
    padding: 0.75rem 2.5rem 0.75rem 1rem; /* 아이콘 공간 확보 */
    border: 1px solid var(--border-light);
    border-radius: 0.75rem;
    background-color: var(--gray-50);
    color: var(--gray-900);
    font-size: 1rem;
    font-family: inherit;
    transition: all 0.2s;
    cursor: pointer;
    
    /* 기본 화살표 제거 */
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;

    /* 커스텀 화살표 아이콘 (회색 #6B7280) */
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236B7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.75rem center;
    background-size: 1.25rem;
}

/* 포커스 시 효과 */
.form-select:focus {
    outline: none;
    box-shadow: 0 0 0 2px var(--primary);
    border-color: transparent;
}

/* --- 다크모드 대응 --- */
body.dark .form-select {
    border-color: var(--border-dark);
    background-color: var(--gray-800);
    color: white;
    /* 다크모드용 흰색 화살표 */
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='white'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
}

/* option 항목 배경색 (다크모드 시 글자 안보임 방지) */
.form-select option {
    background-color: var(--surface-light);
    /* color: var(--gray-900); */
}

body.dark .form-select option {
    background-color: var(--surface-dark);
    color: white;
}

/* 
option{
    color: #f9fafb;
} */

</style>
</head>
<body>
<main class="main-container">
<div class="header">
<div class="logo-circle">
    <a href="home.html"><span class="material-icons-round">palette</span></a>
</div>
<h1 class="header-title">NewsPalette</h1>
<p class="header-subtitle">아이디 찾기</p>
</div>
<form class="idsearch-form" onsubmit="handleSubmit(event)">
<div class="fade-in form-section" id="id-form">
<div class="form-group">
<label class="form-label" for="email">이메일</label>
<div class="input-wrapper">
<div class="input-icon">
<span class="material-icons-round">email</span>
</div>
<input class="form-input" id="email" placeholder="이메일을 입력하세요" type="email"/>
</div>
</div>

<div class="form-group">
<label class="form-label" for="answer">본인 확인 질문</label>
            <select class="form-select" id="security_question" required>
                <option disabled selected value="">질문을 선택해주세요</option>
                <option value="school">다녔던 초등학교 이름은?</option>
                <option value="pet">가장 좋아하는 애완동물 이름은?</option>
                <option value="treasure">나의 보물 1호는?</option>
            </select>
<div class="input-wrapper">
<div class="input-icon">
<span class="material-icons-round">chat_bubble_outline</span>
</div>
<input class="form-input" id="answer" placeholder="답변을 입력하세요" type="text"/>
</div>
</div>

<button class="submit-button" onclick="showResult()">
<span>확인</span>
<span class="material-icons-round">arrow_forward</span>
</button>
</div>
</form>

<div class="hidden-section fade-in result-section" id="id-result">
<div class="result-header">
<p class="result-text">회원님의 아이디를 찾았습니다.</p>
<div class="result-box">
<p class="result-label">
                    아이디: <span class="result-id" id="found-id-text"></span>
</p>
</div>
</div>

<div class="action-buttons">
<a class="back-button" href="login.html">
                로그인 페이지로 돌아가기
            </a>
<button class="reset-button" onclick="resetForm()">
                다른 아이디 찾기
            </button>
</div>
</div>

<div class="footer">
<p class="footer-text">© 2026 NewsPalette. All rights reserved.</p>
</div>
</main>

<script>
function showResult() {
    // 1. 값 가져오기
    const emailValue = $('#email').val();
    const questionValue = $('#security_question').val(); // 질문 선택 여부 확인용
    const answerValue = $('#answer').val();              // 실제 답변 (백엔드로 보낼 값)

    // 2. 유효성 검사
    if (!emailValue || !questionValue || !answerValue) {
        alert('모든 항목을 입력하고 질문을 선택해주세요.');
        return;
    }

    // 3. AJAX 요청
    $.ajax({
        url: '/find-id',
        type: 'POST',
        data: {
            user_email: emailValue,      // 백엔드의 user_email 매개변수
            security_answer: answerValue // 백엔드의 security_answer 매개변수
        },
        success: function(response) {
            if (response.status === "success") {
                // 결과창에 아이디 세팅
                $('#found-id-text').text(response.user_id);
                
                // 화면 전환
                $('#id-form').addClass('hidden-section');
                $('#id-result').removeClass('hidden-section');
            }
        },
        error: function(xhr) {
            // 404 에러 등 (일치 정보 없음) 처리
            const errorMsg = xhr.responseJSON ? xhr.responseJSON.message : "일치하는 정보가 없습니다.";
            alert(errorMsg);
        }
    });
}

function resetForm() {
    $('#id-form').removeClass('hidden-section');
    $('#id-result').addClass('hidden-section');
    $('#email').val('');
    $('#security_question').val('');
    $('#answer').val('');
    $('#found-id-text').text('');
}
// Form 제출 시 새로고침 방지용
function handleSubmit(event) {
    event.preventDefault();
    showResult();
}

// Optional: Dark mode toggle
function toggleDarkMode() {
    document.body.classList.toggle('dark');
    localStorage.setItem('darkMode', document.body.classList.contains('dark'));
}

// Load dark mode preference
if (localStorage.getItem('darkMode') === 'true') {
    document.body.classList.add('dark');
}
</script>

</body>
</html>